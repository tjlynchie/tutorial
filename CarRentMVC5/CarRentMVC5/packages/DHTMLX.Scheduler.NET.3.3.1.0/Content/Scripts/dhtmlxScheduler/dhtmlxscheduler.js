/*
@license
dhtmlxScheduler.Net v.3.3.0 

This software is covered by DHTMLX Evaluation License. Contact sales@dhtmlx.com to get Commercial or Enterprise license. Usage without proper license is prohibited.

(c) Dinamenta, UAB.
*/
function dtmlXMLLoaderObject(e,t,a,n){return this.xmlDoc="",this.async="undefined"!=typeof a?a:!0,this.onloadAction=e||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=n||!1,this}function callerFunction(e,t){return this.handler=function(a){return a||(a=window.event),e(a,t),!0},this.handler}function getAbsoluteLeft(e){return getOffset(e).left}function getAbsoluteTop(e){return getOffset(e).top}function getOffsetSum(e){for(var t=0,a=0;e;)t+=parseInt(e.offsetTop),a+=parseInt(e.offsetLeft),e=e.offsetParent;

return{top:t,left:a}}function getOffsetRect(e){var t=e.getBoundingClientRect(),a=document.body,n=document.documentElement,i=window.pageYOffset||n.scrollTop||a.scrollTop,r=window.pageXOffset||n.scrollLeft||a.scrollLeft,s=n.clientTop||a.clientTop||0,d=n.clientLeft||a.clientLeft||0,o=t.top+i-s,_=t.left+r-d;return{top:Math.round(o),left:Math.round(_)}}function getOffset(e){return e.getBoundingClientRect?getOffsetRect(e):getOffsetSum(e)}function convertStringToBoolean(e){switch("string"==typeof e&&(e=e.toLowerCase()),
e){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(e){return-1!=e.indexOf("?")?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function _dhtmlxError(e,t,a){return this.catches||(this.catches=[]),this}function dhtmlXHeir(e,t){for(var a in t)"function"==typeof t[a]&&(e[a]=t[a]);

return e}function dataProcessor(e){return this.serverProcessor=e,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",
error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this}window.dhtmlXScheduler=window.scheduler={version:"4.3.0"},window.dhtmlx||(dhtmlx=function(e){for(var t in e)dhtmlx[t]=e[t];return dhtmlx}),dhtmlx.extend_api=function(e,t,a){var n=window[e];n&&(window[e]=function(e){var a;if(e&&"object"==typeof e&&!e.tagName){a=n.apply(this,t._init?t._init(e):arguments);for(var i in dhtmlx)t[i]&&this[t[i]](dhtmlx[i]);for(var i in e)t[i]?this[t[i]](e[i]):0===i.indexOf("on")&&this.attachEvent(i,e[i]);

}else a=n.apply(this,arguments);return t._patch&&t._patch(this),a||this},window[e].prototype=n.prototype,a&&dhtmlXHeir(window[e].prototype,a))},dhtmlxAjax={get:function(e,t){var a=new dtmlXMLLoaderObject(!0);return a.async=arguments.length<3,a.waitCall=t,a.loadXML(e),a},post:function(e,t,a){var n=new dtmlXMLLoaderObject(!0);return n.async=arguments.length<4,n.waitCall=a,n.loadXML(e,!0,t),n},getSync:function(e){return this.get(e,null,!0)},postSync:function(e,t){return this.post(e,t,null,!0)}},dtmlXMLLoaderObject.count=0,
dtmlXMLLoaderObject.prototype.waitLoadFunction=function(e){var t=!0;return this.check=function(){if(e&&e.onloadAction&&(!e.xmlDoc.readyState||4==e.xmlDoc.readyState)){if(!t)return;t=!1,dtmlXMLLoaderObject.count++,"function"==typeof e.onloadAction&&e.onloadAction(e.mainObject,null,null,null,e),e.waitCall&&(e.waitCall.call(this,e),e.waitCall=null)}},this.check},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(e,t){var a;if(this.xmlDoc.responseXML){var n=this.xmlDoc.responseXML.getElementsByTagName(e);

if(0===n.length&&-1!=e.indexOf(":"))var n=this.xmlDoc.responseXML.getElementsByTagName(e.split(":")[1]);a=n[0]}else a=this.xmlDoc.documentElement;if(a)return this._retry=!1,a;if(!this._retry&&_isIE){this._retry=!0;var t=this.xmlDoc;return this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(e,t)}return dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("DIV")},dtmlXMLLoaderObject.prototype.loadXMLString=function(e,t){
if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(e);else{var a=new DOMParser;this.xmlDoc=a.parseFromString(e,"text/xml")}t||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(e,t,a,n){this.rSeed&&(e+=(-1!=e.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=e,
this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),"string"==typeof t?this.xmlDoc.open(t,e,this.async):this.xmlDoc.open(t?"POST":"GET",e,this.async),n?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded"),
this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(null||a),this.async||new this.waitLoadFunction(this)()},dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,
this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null,null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(e){for(var t={},a=0;a<e.attributes.length;a++)t[e.attributes[a].name]=e.attributes[a].value;t._tagvalue=e.firstChild?e.firstChild.nodeValue:"";for(var a=0;a<e.childNodes.length;a++){var n=e.childNodes[a].tagName;n&&(t[n]||(t[n]=[]),t[n].push(this.xmlNodeToJSON(e.childNodes[a])))}return t},dhtmlDragAndDropObject.prototype.removeDraggableItem=function(e){
e.onmousedown=null,e.dragStarter=null,e.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(e,t){e.onmousedown=this.preCreateDragCopy,e.dragStarter=t,this.addDragLanding(e,t)},dhtmlDragAndDropObject.prototype.addDragLanding=function(e,t){e.dragLanding=t},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(e){return!e&&!window.event||2!=(e||event).button?window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,
document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(e),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,
window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),e&&e.preventDefault?(e.preventDefault(),!1):!1):void 0},dhtmlDragAndDropObject.prototype.callDrag=function(e){e||(e=window.event);var t=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-t.downtime<100)){if(!t.dragNode){if(!t.waitDrag)return t.stopDrag(e,!0);if(t.dragNode=t.dragStartObject._createDragNode(t.dragStartNode,e),!t.dragNode)return t.stopDrag();t.dragNode.onselectstart=function(){return!1},t.gldragNode=t.dragNode,document.body.appendChild(t.dragNode),
document.body.onmouseup=t.stopDrag,t.waitDrag=0,t.dragNode.pWindow=window,t.initFrameRoute()}if(t.dragNode.parentNode!=window.document.body&&t.gldragNode){var a=t.gldragNode;t.gldragNode.old&&(a=t.gldragNode.old),a.parentNode.removeChild(a);var n=t.dragNode.pWindow;if(a.pWindow&&a.pWindow.dhtmlDragAndDrop.lastLanding&&a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var i=document.createElement("Div");i.innerHTML=t.dragNode.outerHTML,t.dragNode=i.childNodes[0];

}else t.dragNode=t.dragNode.cloneNode(!0);t.dragNode.pWindow=window,t.gldragNode.old=t.dragNode,document.body.appendChild(t.dragNode),n.dhtmlDragAndDrop.dragNode=t.dragNode}t.dragNode.style.left=e.clientX+15+(t.fx?-1*t.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",t.dragNode.style.top=e.clientY+3+(t.fy?-1*t.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";var r;r=e.srcElement?e.srcElement:e.target,t.checkLanding(r,e)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){
if(window.name){for(var t=parent.frames[window.name].frameElement.offsetParent,a=0,n=0;t;)a+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;if(parent.dhtmlDragAndDrop){var i=parent.dhtmlDragAndDrop.calculateFramePosition(1);a+=1*i.split("_")[0],n+=1*i.split("_")[1]}if(e)return a+"_"+n;this.fx=a,this.fy=n}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(e,t){e&&e.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=e,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),
this.lastLanding_scr=_isIE?t.srcElement:t.target):e&&"BODY"!=e.tagName?this.checkLanding(e.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(e,t){var a=window.dhtmlDragAndDrop;if(!t){a.stopFrameRoute();var n=a.lastLanding;a.lastLanding=null,n&&n.dragLanding._drag(a.dragStartNode,a.dragStartObject,n,_isIE?event.srcElement:e.target);

}a.lastLanding=null,a.dragNode&&a.dragNode.parentNode==document.body&&a.dragNode.parentNode.removeChild(a.dragNode),a.dragNode=0,a.gldragNode=0,a.fx=0,a.fy=0,a.dragStartNode=0,a.dragStartObject=0,document.body.onmouseup=a.tempDOMU,document.body.onmousemove=a.tempDOMM,a.tempDOMU=null,a.tempDOMM=null,a.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(e){e&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=e&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window);

}catch(a){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(a){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(e,t){e&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=e.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=e.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=e.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=e.dhtmlDragAndDrop.dragNode,
window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(a){}for(var n=0;n<window.frames.length;n++)try{window.frames[n]!=e&&window.frames[n].dhtmlDragAndDrop&&window.frames[n].dhtmlDragAndDrop.initFrameRoute(window,!e||t?1:0)}catch(a){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,
_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,
-1==navigator.appVersion.indexOf("MSIE 8.0")&&-1==navigator.appVersion.indexOf("MSIE 9.0")&&-1==navigator.appVersion.indexOf("MSIE 10.0")||"BackCompat"==document.compatMode||(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),dtmlXMLLoaderObject.prototype.doXPath=function(e,t,a,n){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(e,t);if(_isIE)return t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),
t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),a&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+a+"'"),"single"==n?t.selectSingleNode(e):t.selectNodes(e)||new Array(0);var i=t;t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),-1!=t.nodeName.indexOf("document")?i=t:(i=t,t=t.ownerDocument);var r=XPathResult.ANY_TYPE;"single"==n&&(r=XPathResult.FIRST_ORDERED_NODE_TYPE);

var s=[],d=t.evaluate(e,i,function(e){return a},r,null);if(r==XPathResult.FIRST_ORDERED_NODE_TYPE)return d.singleNodeValue;for(var o=d.iterateNext();o;)s[s.length]=o,o=d.iterateNext();return s},_dhtmlxError.prototype.catchError=function(e,t){this.catches[e]=t},_dhtmlxError.prototype.throwError=function(e,t,a){return this.catches[e]?this.catches[e](e,t,a):this.catches.ALL?this.catches.ALL(e,t,a):(window.alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]),null)},window.dhtmlxError=new _dhtmlxError,
dtmlXMLLoaderObject.prototype.doXPathOpera=function(e,t){var a=e.replace(/[\/]+/gi,"/").split("/"),n=null,i=1;if(!a.length)return[];if("."==a[0])n=[t];else{if(""!==a[0])return[];n=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(a[i].replace(/\[[^\]]*\]/g,"")),i++}for(i;i<a.length;i++)n=this._getAllNamedChilds(n,a[i]);return-1!=a[i-1].indexOf("[")&&(n=this._filterXPath(n,a[i-1])),n},dtmlXMLLoaderObject.prototype._filterXPath=function(e,t){for(var a=[],t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),n=0;n<e.length;n++)e[n].getAttribute(t)&&(a[a.length]=e[n]);

return a},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,t){var a=[];_isKHTML&&(t=t.toUpperCase());for(var n=0;n<e.length;n++)for(var i=0;i<e[n].childNodes.length;i++)_isKHTML?e[n].childNodes[i].tagName&&e[n].childNodes[i].tagName.toUpperCase()==t&&(a[a.length]=e[n].childNodes[i]):e[n].childNodes[i].tagName==t&&(a[a.length]=e[n].childNodes[i]);return a},"undefined"==typeof window.dhtmlxEvent&&(window.dhtmlxEvent=function(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent&&e.attachEvent("on"+t,a);

}),dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(e,t,a){a||(a=this.xslDoc),a.responseXML&&(a=a.responseXML);var n=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+e+"']",a,"http://www.w3.org/1999/XSL/Transform","single");n&&(n.firstChild.nodeValue=t)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(e,t){e||(e=this.xslDoc),e.responseXML&&(e=e.responseXML),t||(t=this.xmlDoc),t.responseXML&&(t=t.responseXML);var a;if(_isIE){a=new ActiveXObject("Msxml2.DOMDocument.3.0");

try{t.transformNodeToObject(e,a)}catch(n){a=t.transformNode(e)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(e)),a=this.XSLProcessor.transformToDocument(t);return a},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(e,t){var a=this.doXSLTransToObject(e,t);return"string"==typeof a?a:this.doSerialization(a)},dtmlXMLLoaderObject.prototype.doSerialization=function(e){if(e||(e=this.xmlDoc),e.responseXML&&(e=e.responseXML),_isIE)return e.xml;var t=new XMLSerializer;

return t.serializeToString(e)},dhtmlxEventable=function(obj){obj.attachEvent=function(e,t,a){return e="ev_"+e.toLowerCase(),this[e]||(this[e]=new this.eventCatcher(a||this)),e+":"+this[e].addEvent(t)},obj.callEvent=function(e,t){return e="ev_"+e.toLowerCase(),this[e]?this[e].apply(this,t):!0},obj.checkEvent=function(e){return!!this["ev_"+e.toLowerCase()]},obj.eventCatcher=function(obj){var dhx_catch=[],z=function(){for(var e=!0,t=0;t<dhx_catch.length;t++)if(dhx_catch[t]){var a=dhx_catch[t].apply(obj,arguments);

e=e&&a}return e};return z.addEvent=function(ev){return"function"!=typeof ev&&(ev=eval(ev)),ev?dhx_catch.push(ev)-1:!1},z.removeEvent=function(e){dhx_catch[e]=null},z},obj.detachEvent=function(e){if(e){var t=e.split(":");this[t[0]].removeEvent(t[1])}},obj.detachAllEvents=function(){for(var e in this)0===e.indexOf("ev_")&&(this.detachEvent(e),this[e]=null)},obj=null},window.dhtmlx||(window.dhtmlx={}),function(){function e(e,t){var n=e.callback;a(!1),e.box.parentNode.removeChild(e.box),c=e.box=null,
n&&n(t)}function t(t){if(c){t=t||event;var a=t.which||event.keyCode;return dhtmlx.message.keyboard&&((13==a||32==a)&&e(c,!0),27==a&&e(c,!1)),t.preventDefault&&t.preventDefault(),!(t.cancelBubble=!0)}}function a(e){a.cover||(a.cover=document.createElement("DIV"),a.cover.onkeydown=t,a.cover.className="dhx_modal_cover",document.body.appendChild(a.cover));document.body.scrollHeight;a.cover.style.display=e?"inline-block":"none"}function n(e,t,a){var n=a?a:e||"",i="dhtmlx_"+n.toLowerCase().replace(/ /g,"_")+"_button";

return"<div class='dhtmlx_popup_button "+i+"' result='"+t+"' ><div>"+e+"</div></div>"}function i(e){u.area||(u.area=document.createElement("DIV"),u.area.className="dhtmlx_message_area",u.area.style[u.position]="5px",document.body.appendChild(u.area)),u.hide(e.id);var t=document.createElement("DIV");return t.innerHTML="<div>"+e.text+"</div>",t.className="dhtmlx-info dhtmlx-"+e.type,t.onclick=function(){u.hide(e.id),e=null},"bottom"==u.position&&u.area.firstChild?u.area.insertBefore(t,u.area.firstChild):u.area.appendChild(t),
e.expire>0&&(u.timers[e.id]=window.setTimeout(function(){u.hide(e.id)},e.expire)),u.pull[e.id]=t,t=null,e.id}function r(t,a,i){var r=document.createElement("DIV");r.className=" dhtmlx_modal_box dhtmlx-"+t.type,r.setAttribute("dhxbox",1);var s="";if(t.width&&(r.style.width=t.width),t.height&&(r.style.height=t.height),t.title&&(s+='<div class="dhtmlx_popup_title">'+t.title+"</div>"),s+='<div class="dhtmlx_popup_text"><span>'+(t.content?"":t.text)+'</span></div><div  class="dhtmlx_popup_controls">',
a){var d=t.ok||scheduler.locale.labels.message_ok;void 0===d&&(d="OK"),s+=n(d,!0,"ok")}if(i){var o=t.cancel||scheduler.locale.labels.message_cancel;void 0===o&&(o="Cancel"),s+=n(o,!1,"cancel")}if(t.buttons)for(var _=0;_<t.buttons.length;_++)s+=n(t.buttons[_],_);if(s+="</div>",r.innerHTML=s,t.content){var l=t.content;"string"==typeof l&&(l=document.getElementById(l)),"none"==l.style.display&&(l.style.display=""),r.childNodes[t.title?1:0].appendChild(l)}return r.onclick=function(a){a=a||event;var n=a.target||a.srcElement;

if(n.className||(n=n.parentNode),"dhtmlx_popup_button"==n.className.split(" ")[0]){var i=n.getAttribute("result");i="true"==i||("false"==i?!1:i),e(t,i)}},t.box=r,(a||i)&&(c=t),r}function s(e,n,i){var s=e.tagName?e:r(e,n,i);e.hidden||a(!0),document.body.appendChild(s);var d=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-s.offsetWidth)/2)),o=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-s.offsetHeight)/2));return s.style.top="top"==e.position?"-3px":o+"px",
s.style.left=d+"px",s.onkeydown=t,s.focus(),e.hidden&&dhtmlx.modalbox.hide(s),s}function d(e){return s(e,!0,!1)}function o(e){return s(e,!0,!0)}function _(e){return s(e)}function l(e,t,a){return"object"!=typeof e&&("function"==typeof t&&(a=t,t=""),e={text:e,type:t,callback:a}),e}function h(e,t,a,n){return"object"!=typeof e&&(e={text:e,type:t,expire:a,id:n}),e.id=e.id||u.uid(),e.expire=e.expire||u.expire,e}var c=null;document.attachEvent?document.attachEvent("onkeydown",t):document.addEventListener("keydown",t,!0),
dhtmlx.alert=function(){var e=l.apply(this,arguments);return e.type=e.type||"confirm",d(e)},dhtmlx.confirm=function(){var e=l.apply(this,arguments);return e.type=e.type||"alert",o(e)},dhtmlx.modalbox=function(){var e=l.apply(this,arguments);return e.type=e.type||"alert",_(e)},dhtmlx.modalbox.hide=function(e){for(;e&&e.getAttribute&&!e.getAttribute("dhxbox");)e=e.parentNode;e&&(e.parentNode.removeChild(e),a(!1))};var u=dhtmlx.message=function(e,t,a,n){e=h.apply(this,arguments),e.type=e.type||"info";

var r=e.type.split("-")[0];switch(r){case"alert":return d(e);case"confirm":return o(e);case"modalbox":return _(e);default:return i(e)}};u.seed=(new Date).valueOf(),u.uid=function(){return u.seed++},u.expire=4e3,u.keyboard=!0,u.position="top",u.pull={},u.timers={},u.hideAll=function(){for(var e in u.pull)u.hide(e)},u.hide=function(e){var t=u.pull[e];t&&t.parentNode&&(window.setTimeout(function(){t.parentNode.removeChild(t),t=null},2e3),t.className+=" hidden",u.timers[e]&&window.clearTimeout(u.timers[e]),
delete u.pull[e])}}(),dataProcessor.prototype={setTransactionMode:function(e,t){this._tMode=e,this._tSend=t,"REST"==e&&(this._tSend=!1,this._endnm=!0)},escape:function(e){return this._utf?encodeURIComponent(e):escape(e)},enableUTFencoding:function(e){this._utf=convertStringToBoolean(e)},setDataColumns:function(e){this._columns="string"==typeof e?e.split(","):e},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(e){this._endnm=convertStringToBoolean(e)},enablePartialDataSend:function(e){
this._changed=convertStringToBoolean(e)},setUpdateMode:function(e,t){this.autoUpdate="cell"==e,this.updateMode=e,this.dnd=t},ignore:function(e,t){this._silent_mode=!0,e.call(t||window),this._silent_mode=!1},setUpdated:function(e,t,a){if(!this._silent_mode){var n=this.findRow(e);a=a||"updated";var i=this.obj.getUserData(e,this.action_param);i&&"updated"==a&&(a=i),t?(this.set_invalid(e,!1),this.updatedRows[n]=e,this.obj.setUserData(e,this.action_param,a),this._in_progress[e]&&(this._in_progress[e]="wait")):this.is_invalid(e)||(this.updatedRows.splice(n,1),
this.obj.setUserData(e,this.action_param,"")),t||this._clearUpdateFlag(e),this.markRow(e,t,a),t&&this.autoUpdate&&this.sendData(e)}},_clearUpdateFlag:function(e){},markRow:function(e,t,a){var n="",i=this.is_invalid(e);if(i&&(n=this.styles[i],t=!0),this.callEvent("onRowMark",[e,t,a,i])&&(n=this.styles[t?a:"clear"]+n,this.obj[this._methods[0]](e,n),i&&i.details)){n+=this.styles[i+"_cell"];for(var r=0;r<i.details.length;r++)i.details[r]&&this.obj[this._methods[1]](e,r,n)}},getState:function(e){return this.obj.getUserData(e,this.action_param);

},is_invalid:function(e){return this._invalid[e]},set_invalid:function(e,t,a){a&&(t={value:t,details:a,toString:function(){return this.value.toString()}}),this._invalid[e]=t},checkBeforeUpdate:function(e){return!0},sendData:function(e){return!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2?(this.obj.editStop&&this.obj.editStop(),"undefined"==typeof e||this._tSend?this.sendAllData():this._in_progress[e]?!1:(this.messages=[],!this.checkBeforeUpdate(e)&&this.callEvent("onValidationError",[e,this.messages])?!1:void this._beforeSendData(this._getRowData(e),e))):void 0;

},_beforeSendData:function(e,t){return this.callEvent("onBeforeUpdate",[t,this.getState(t),e])?void this._sendData(e,t):!1},serialize:function(e,t){if("string"==typeof e)return e;if("undefined"!=typeof t)return this.serialize_one(e,"");var a=[],n=[];for(var i in e)e.hasOwnProperty(i)&&(a.push(this.serialize_one(e[i],i+this.post_delim)),n.push(i));return a.push("ids="+this.escape(n.join(","))),dhtmlx.security_key&&a.push("dhx_security="+dhtmlx.security_key),a.join("&")},serialize_one:function(e,t){
if("string"==typeof e)return e;var a=[];for(var n in e)if(e.hasOwnProperty(n)){if(("id"==n||n==this.action_param)&&"REST"==this._tMode)continue;a.push(this.escape((t||"")+n)+"="+this.escape(e[n]))}return a.join("&")},_sendData:function(e,t){if(e){if(!this.callEvent("onBeforeDataSending",t?[t,this.getState(t),e]:[null,null,e]))return!1;t&&(this._in_progress[t]=(new Date).valueOf());var a=new dtmlXMLLoaderObject(function(a,n,i,r,s){var d=[];if(t)d.push(t);else if(e)for(var o in e)d.push(o);return a.afterUpdate(a,s,d);

},this,!0),n=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");if("GET"==this._tMode)a.loadXML(n+(-1!=n.indexOf("?")?"&":"?")+this.serialize(e,t));else if("POST"==this._tMode)a.loadXML(n,!0,this.serialize(e,t));else if("REST"==this._tMode){var i=this.getState(t),r=n.replace(/(\&|\?)editing\=true/,"");"inserted"==i?a.loadXML(r+t,"POST",this.serialize(e,t)):"deleted"==i?a.loadXML(r+t,"DELETE",""):a.loadXML(r+t,"PUT",this.serialize(e,t));

}this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var e=!0,t=0;t<this.updatedRows.length;t++)e&=this.checkBeforeUpdate(this.updatedRows[t]);if(!e&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(var t=0;t<this.updatedRows.length;t++)if(!this._in_progress[this.updatedRows[t]]){if(this.is_invalid(this.updatedRows[t]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[t]),this.updatedRows[t]),
this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(e){for(var t={},a=!1,n=0;n<this.updatedRows.length;n++){var i=this.updatedRows[n];this._in_progress[i]||this.is_invalid(i)||this.callEvent("onBeforeUpdate",[i,this.getState(i),this._getRowData(i)])&&(t[i]=this._getRowData(i,i+this.post_delim),a=!0,this._in_progress[i]=(new Date).valueOf())}return a?t:null},setVerificator:function(e,t){this.mandatoryFields[e]=t||function(e){return""!==e}},clearVerificator:function(e){
this.mandatoryFields[e]=!1},findRow:function(e){var t=0;for(t=0;t<this.updatedRows.length&&e!=this.updatedRows[t];t++);return t},defineAction:function(e,t){this._uActions||(this._uActions=[]),this._uActions[e]=t},afterUpdateCallback:function(e,t,a,n){var i=e,r="error"!=a&&"invalid"!=a;if(r||this.set_invalid(e,a),this._uActions&&this._uActions[a]&&!this._uActions[a](n))return delete this._in_progress[i];"wait"!=this._in_progress[i]&&this.setUpdated(e,!1);var s=e;switch(a){case"inserted":case"insert":
t!=e&&(this.obj[this._methods[2]](e,t),e=t);break;case"delete":case"deleted":return this.obj.setUserData(e,this.action_param,"true_deleted"),this.obj[this._methods[3]](e),delete this._in_progress[i],this.callEvent("onAfterUpdate",[e,a,t,n])}"wait"!=this._in_progress[i]?(r&&this.obj.setUserData(e,this.action_param,""),delete this._in_progress[i]):(delete this._in_progress[i],this.setUpdated(t,!0,this.obj.getUserData(e,this.action_param))),this.callEvent("onAfterUpdate",[s,a,t,n])},afterUpdate:function(e,t,a){
if(window.JSON)try{var n=JSON.parse(t.xmlDoc.responseText),i=n.action||this.getState(a)||"updated",r=n.sid||a[0],s=n.tid||a[0];return e.afterUpdateCallback(r,s,i,n),void e.finalizeUpdate()}catch(d){}if(t.getXMLTopNode("data"),!t.xmlDoc.responseXML)return this.obj&&this.obj.callEvent&&this.obj.callEvent("onSaveError",[a,t.xmlDoc]),this.cleanUpdate(a);var o=t.doXPath("//data/action");if(!o.length)return this.cleanUpdate(a);for(var _=0;_<o.length;_++){var l=o[_],i=l.getAttribute("type"),r=l.getAttribute("sid"),s=l.getAttribute("tid");

e.afterUpdateCallback(r,s,i,l)}e.finalizeUpdate()},cleanUpdate:function(e){if(e)for(var t=0;t<e.length;t++)delete this._in_progress[e[t]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(e){this.obj=e,this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(e){this.attachEvent("onAfterUpdate",e);

},enableDebug:function(e){},setOnBeforeUpdateHandler:function(e){this.attachEvent("onBeforeDataSending",e)},setAutoUpdate:function(e,t){e=e||2e3,this._user=t||(new Date).valueOf(),this._need_update=!1,this._loader=null,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(e,t,a,n){this.afterAutoUpdate(e,t,a,n)}),this.attachEvent("onFullSync",function(){this.fullSync()});var a=this;window.setInterval(function(){a.loadUpdate()},e)},afterAutoUpdate:function(e,t,a,n){return"collision"==t?(this._need_update=!0,
!1):!0},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(e,t){return this._update_busy?!1:(this._update_busy=!0,this._loader=this._loader||new dtmlXMLLoaderObject(!0),this._loader.async=!0,this._loader.waitCall=t,void this._loader.loadXML(e))},_v:function(e){return e.firstChild?e.firstChild.nodeValue:""},_a:function(e){for(var t=[],a=0;a<e.length;a++)t[a]=this._v(e[a]);return t},loadUpdate:function(){var e=this,t=this.obj.getUserData(0,"version"),a=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+t].join("&");

a=a.replace("editing=true&",""),this.getUpdates(a,function(){var t=e._loader.doXPath("//userdata");e.obj.setUserData(0,"version",e._v(t[0]));var a=e._loader.doXPath("//update");if(a.length){e._silent_mode=!0;for(var n=0;n<a.length;n++){var i=a[n].getAttribute("status"),r=a[n].getAttribute("id"),s=a[n].getAttribute("parent");switch(i){case"inserted":e.callEvent("insertCallback",[a[n],r,s]);break;case"updated":e.callEvent("updateCallback",[a[n],r,s]);break;case"deleted":e.callEvent("deleteCallback",[a[n],r,s]);

}}e._silent_mode=!1}e._update_busy=!1,e=null})}},window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(e){this.init_original(e),e._dataprocessor=this,this.setTransactionMode("POST",!0),this.serverProcessor+=(-1!=this.serverProcessor.indexOf("?")?"&":"?")+"editing=true"}),dhtmlxError.catchError("LoadXML",function(e,t,a){var n=a[0].responseText;switch(scheduler.config.ajax_error){case"alert":
window.alert(n);break;case"console":window.console.log(n)}}),window.Scheduler={_seed:0},Scheduler.plugin=function(e){this._schedulerPlugins.push(e),e(window.scheduler)},Scheduler._schedulerPlugins=[],Scheduler.getSchedulerInstance=function(){var scheduler={version:"4.3.0"};dhtmlxEventable(scheduler),scheduler._detachDomEvent=function(e,t,a){e.removeEventListener?e.removeEventListener(t,a,!1):e.detachEvent&&e.detachEvent("on"+t,a)},scheduler._init_once=function(){function e(){return{w:window.innerWidth||document.documentElement.clientWidth,
h:window.innerHeight||document.documentElement.clientHeight}}function t(e,t){return e.w==t.w&&e.h==t.h}var a=e();dhtmlxEvent(window,"resize",function(){var n=e();t(a,n)||(window.clearTimeout(scheduler._resize_timer),scheduler._resize_timer=window.setTimeout(function(){scheduler.callEvent("onSchedulerResize",[])&&(scheduler.update_view(),scheduler.callEvent("onAfterSchedulerResize",[]))},100)),a=n}),scheduler._init_once=function(){}},scheduler.init=function(e,t,a){t=t||scheduler._currentDate(),a=a||"week",
this._obj&&this.unset_actions(),this._obj="string"==typeof e?document.getElementById(e):e,this._skin_init&&scheduler._skin_init(),scheduler.date.init(),this._els=[],this._scroll=!0,this._quirks=_isIE&&"BackCompat"==document.compatMode,this._quirks7=_isIE&&-1==navigator.appVersion.indexOf("MSIE 8"),this.get_elements(),this.init_templates(),this.set_actions(),this._init_once(),this._init_touch_events(),this.set_sizes(),scheduler.callEvent("onSchedulerReady",[]),this.setCurrentView(t,a)},scheduler.xy={
min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22},scheduler.keys={edit_save:13,edit_cancel:27},scheduler.set_sizes=function(){var e=this._x=this._obj.clientWidth-this.xy.margin_left,t=this._y=this._obj.clientHeight-this.xy.margin_top,a=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,n=this._table_view?-1:this.xy.scale_width;this.set_xy(this._els.dhx_cal_navline[0],e,this.xy.nav_height,0,0),
this.set_xy(this._els.dhx_cal_header[0],e-a,this.xy.scale_height,n,this.xy.nav_height+(this._quirks?-1:1));var i=this._els.dhx_cal_navline[0].offsetHeight;i>0&&(this.xy.nav_height=i);var r=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.set_xy(this._els.dhx_cal_data[0],e,t-(r+2),0,r+2)},scheduler.set_xy=function(e,t,a,n,i){e.style.width=Math.max(0,t)+"px",e.style.height=Math.max(0,a)+"px",arguments.length>3&&(e.style.left=n+"px",e.style.top=i+"px")},scheduler.get_elements=function(){
for(var e=this._obj.getElementsByTagName("DIV"),t=0;t<e.length;t++){var a=e[t].className||"",n=e[t].getAttribute("name")||"";a&&(a=a.split(" ")[0]),this._els[a]||(this._els[a]=[]),this._els[a].push(e[t]);var i=scheduler.locale.labels[n||a];"string"!=typeof i&&n&&!e[t].innerHTML&&(i=n.split("_")[0]),i&&(e[t].innerHTML=i)}},scheduler.unset_actions=function(){for(var e in this._els)if(this._click[e])for(var t=0;t<this._els[e].length;t++)this._els[e][t].onclick=null;this._obj.onselectstart=null,this._obj.onmousemove=null,
this._obj.onmousedown=null,this._obj.onmouseup=null,this._obj.ondblclick=null,this._obj.oncontextmenu=null},scheduler.set_actions=function(){for(var e in this._els)if(this._click[e])for(var t=0;t<this._els[e].length;t++)this._els[e][t].onclick=scheduler._click[e];this._obj.onselectstart=function(e){return!1},this._obj.onmousemove=function(e){scheduler._temp_touch_block||scheduler._on_mouse_move(e||event)},this._obj.onmousedown=function(e){scheduler._ignore_next_click||scheduler._on_mouse_down(e||event);

},this._obj.onmouseup=function(e){scheduler._ignore_next_click||scheduler._on_mouse_up(e||event)},this._obj.ondblclick=function(e){scheduler._on_dbl_click(e||event)},this._obj.oncontextmenu=function(e){var t=e||event,a=t.target||t.srcElement,n=scheduler.callEvent("onContextMenu",[scheduler._locate_event(a),t]);return n}},scheduler.select=function(e){this._select_id!=e&&(scheduler._close_not_saved(),this.editStop(!1),this.unselect(),this._select_id=e,this.updateEvent(e))},scheduler.unselect=function(e){
if(!e||e==this._select_id){var t=this._select_id;this._select_id=null,t&&this.getEvent(t)&&this.updateEvent(t)}},scheduler.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}},scheduler._click={dhx_cal_data:function(e){if(scheduler._ignore_next_click)return e.preventDefault&&e.preventDefault(),
e.cancelBubble=!0,scheduler._ignore_next_click=!1,!1;var t=e?e.target:event.srcElement,a=scheduler._locate_event(t);if(e=e||event,a){if(!scheduler.callEvent("onClick",[a,e])||scheduler.config.readonly)return}else scheduler.callEvent("onEmptyClick",[scheduler.getActionData(e).date,e]);if(a&&scheduler.config.select){scheduler.select(a);var n=t.className;-1!=n.indexOf("_icon")&&scheduler._click.buttons[n.split(" ")[1].replace("icon_","")](a)}else scheduler._close_not_saved(),(new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler.unselect();

},dhx_cal_prev_button:function(){scheduler._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(e,t){scheduler.setCurrentView(scheduler.date.add(scheduler.date[scheduler._mode+"_start"](scheduler._date),t||1,scheduler._mode))},dhx_cal_today_button:function(){scheduler.callEvent("onBeforeTodayDisplayed",[])&&scheduler.setCurrentView(scheduler._currentDate())},dhx_cal_tab:function(){var e=this.getAttribute("name"),t=e.substring(0,e.search("_tab"));scheduler.setCurrentView(scheduler._date,t);

},buttons:{"delete":function(e){var t=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(t,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(e)})},edit:function(e){scheduler.edit(e)},save:function(e){scheduler.editStop(!0)},details:function(e){scheduler.showLightbox(e)},cancel:function(e){scheduler.editStop(!1)}}},scheduler._dhtmlx_confirm=function(e,t,a){if(!e)return a();var n={text:e};t&&(n.title=t),a&&(n.callback=function(e){e&&a()}),dhtmlx.confirm(n);

},scheduler.addEventNow=function(e,t,a){var n={};e&&null!==e.constructor.toString().match(/object/i)&&(n=e,e=null);var i=6e4*(this.config.event_duration||this.config.time_step);e||(e=n.start_date||Math.round(scheduler._currentDate().valueOf()/i)*i);var r=new Date(e);if(!t){var s=this.config.first_hour;s>r.getHours()&&(r.setHours(s),e=r.valueOf()),t=e.valueOf()+i}var d=new Date(t);r.valueOf()==d.valueOf()&&d.setTime(d.valueOf()+i),n.start_date=n.start_date||r,n.end_date=n.end_date||d,n.text=n.text||this.locale.labels.new_event,
n.id=this._drag_id=this.uid(),this._drag_mode="new-size",this._loading=!0,this.addEvent(n),this.callEvent("onEventCreated",[this._drag_id,a]),this._loading=!1,this._drag_event={},this._on_mouse_up(a)},scheduler._on_dbl_click=function(e,t){if(t=t||e.target||e.srcElement,!this.config.readonly){var a=(t.className||"").split(" ")[0];switch(a){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!scheduler.config.dblclick_create)break;this.addEventNow(this.getActionData(e).date,null,e);

break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":var n=this._locate_event(t);if(!this.callEvent("onDblClick",[n,e]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(n)._timed||!this.config.select?this.showLightbox(n):this.edit(n);break;case"dhx_time_block":case"dhx_cal_container":return;default:var i=this["dblclick_"+a];if(i)i.call(this,e);else if(t.parentNode&&t!=this)return scheduler._on_dbl_click(e,t.parentNode);

}}},scheduler._get_column_index=function(e){var t=0;if(this._cols){for(var a=0,n=0;n<this._cols.length&&!a;n++)a=this._cols[n];if(t=a?e/a:0,this._ignores)for(var n=0;t>=n;n++)this._ignores[n]&&t++}return t},scheduler._week_indexes_from_pos=function(e){if(this._cols){var t=this._get_column_index(e.x);return e.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(t)-1)),e.y=Math.max(0,Math.ceil(60*e.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),
e}return e},scheduler._mouse_coords=function(e){var t,a=document.body,n=document.documentElement;t=_isIE||!e.pageX&&!e.pageY?{x:e.clientX+(a.scrollLeft||n.scrollLeft||0)-a.clientLeft,y:e.clientY+(a.scrollTop||n.scrollTop||0)-a.clientTop}:{x:e.pageX,y:e.pageY},t.x-=getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),t.y-=getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,t.ev=e;var i=this["mouse_"+this._mode];if(i)return i.call(this,t);

if(this._table_view){var r=this._get_column_index(t.x);if(!this._cols||!this._colsS)return t;var s=0;for(s=1;s<this._colsS.heights.length&&!(this._colsS.heights[s]>t.y);s++);t.y=Math.ceil(24*(Math.max(0,r)+7*Math.max(0,s-1))*60/this.config.time_step),(scheduler._drag_mode||"month"==this._mode)&&(t.y=24*(Math.max(0,Math.ceil(r)-1)+7*Math.max(0,s-1))*60/this.config.time_step),"move"==this._drag_mode&&scheduler._ignores_detected&&scheduler.config.preserve_length&&(t._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{
x_step:1,x_unit:"day"}))),t.x=0}else t=this._week_indexes_from_pos(t);return t},scheduler._close_not_saved=function(){if((new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler._edit_id){var e=scheduler.locale.labels.confirm_closing;scheduler._dhtmlx_confirm(e,scheduler.locale.labels.title_confirm_closing,function(){scheduler.editStop(scheduler.config.positive_closing)}),e&&(this._drag_id=this._drag_pos=this._drag_mode=null)}},scheduler._correct_shift=function(e,t){return e-=6e4*(new Date(scheduler._min_date).getTimezoneOffset()-new Date(e).getTimezoneOffset())*(t?-1:1);

},scheduler._is_pos_changed=function(e,t){function a(e,t,a){return!!(Math.abs(e-t)>a)}var n=100,i=5;return!!(!this._drag_pos.start||+new Date-this._drag_pos.start>n||a(e.x,t.x,i)||a(e.y,t.y,i))},scheduler._on_mouse_move=function(e){if(this._drag_mode){var t=this._mouse_coords(e);if(t.force_redraw||this._is_pos_changed(this._drag_pos,t)){var a,n;if(this._edit_id!=this._drag_id&&this._close_not_saved(),!this._drag_mode)return;if(this._drag_pos=t,this._drag_pos.has_moved=!0,"create"==this._drag_mode){
if(this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,a=this._get_date_from_pos(t).valueOf(),!this._drag_start){var i=this.callEvent("onBeforeEventCreated",[e,this._drag_id]);if(!i)return;return void(this._drag_start=a)}n=a,n==this._drag_start;var r=new Date(this._drag_start),s=new Date(n);"day"!=this._mode&&"week"!=this._mode||r.getHours()!=s.getHours()||r.getMinutes()!=s.getMinutes()||(s=new Date(this._drag_start+1e3)),this._drag_id=this.uid(),this.addEvent(r,s,this.locale.labels.new_event,this._drag_id,t.fields),
this.callEvent("onEventCreated",[this._drag_id,e]),this._loading=!1,this._drag_mode="new-size"}var d,o=this.getEvent(this._drag_id);if("move"==this._drag_mode)a=this._min_date.valueOf()+6e4*(t.y*this.config.time_step+24*t.x*60-(scheduler._move_pos_shift||0)),!t.custom&&this._table_view&&(a+=1e3*this.date.time_part(o.start_date)),a=this._correct_shift(a),t._ignores&&this.config.preserve_length&&this._table_view?(this.matrix&&(d=this.matrix[this._mode]),d=d||{x_step:1,x_unit:"day"},n=1*a+this._get_fictional_event_length(a,this._drag_event._event_length,d)):n=o.end_date.valueOf()-(o.start_date.valueOf()-a);
else{if(a=o.start_date.valueOf(),n=o.end_date.valueOf(),this._table_view){var _=this._min_date.valueOf()+t.y*this.config.time_step*6e4+(t.custom?0:864e5);if("month"==this._mode)if(_=this._correct_shift(_,!1),this._drag_from_start){var l=864e5;_<=scheduler.date.date_part(new Date(n+l-1)).valueOf()&&(a=_-l)}else n=_;else t.resize_from_start?a=_:n=_}else n=this.date.date_part(new Date(o.end_date.valueOf()-1)).valueOf()+t.y*this.config.time_step*6e4,this._els.dhx_cal_data[0].style.cursor="s-resize",("week"==this._mode||"day"==this._mode)&&(n=this._correct_shift(n));

if("new-size"==this._drag_mode)if(n<=this._drag_start){var h=t.shift||(this._table_view&&!t.custom?864e5:0);a=n-(t.shift?0:h),n=this._drag_start+(h||6e4*this.config.time_step)}else a=this._drag_start;else a>=n&&(n=a+6e4*this.config.time_step)}var c=new Date(n-1),u=new Date(a);if(scheduler.config.limit_drag_out&&(+u<+scheduler._min_date||+n>+scheduler._max_date)){var v=n-u;+u<+scheduler._min_date?(u=new Date(scheduler._min_date),n=new Date(+u+v)):(n=new Date(scheduler._max_date),u=new Date(+n-v));
var c=new Date(n-1)}if(!this._table_view&&!scheduler.config.all_timed&&(!scheduler._get_section_view()&&t.x!=this._get_event_sday({start_date:new Date(n),end_date:new Date(n)})||new Date(n).getHours()>=this.config.last_hour)){var v=n-u,l=this._min_date.valueOf()+24*t.x*60*6e4;n=scheduler.date.date_part(new Date(l)),n.setHours(this.config.last_hour),c=new Date(n-1),"move"==this._drag_mode&&(u=new Date(+n-v))}if(this._table_view||c.getDate()==u.getDate()&&c.getHours()<this.config.last_hour||scheduler._allow_dnd)if(o.start_date=u,
o.end_date=new Date(n),this.config.update_render){var f=scheduler._els.dhx_cal_data[0].scrollTop;this.update_view(),scheduler._els.dhx_cal_data[0].scrollTop=f}else this.updateEvent(this._drag_id);this._table_view&&this.for_rendered(this._drag_id,function(e){e.className+=" dhx_in_move"}),this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,e])}}else if(scheduler.checkEvent("onMouseMove")){var g=this._locate_event(e.target||e.srcElement);this.callEvent("onMouseMove",[g,e])}},scheduler._on_mouse_down=function(e,t){
if(2!=e.button&&!this.config.readonly&&!this._drag_mode){t=t||e.target||e.srcElement;var a=t.className&&t.className.split(" ")[0];switch(a){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize",scheduler._drag_from_start=(t.className||"").indexOf("dhx_event_resize_end")<0?!0:!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":
case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(t.parentNode)return scheduler._on_mouse_down(e,t.parentNode);break;default:if((!scheduler.checkEvent("onMouseDown")||scheduler.callEvent("onMouseDown",[a]))&&t.parentNode&&t!=this&&"dhx_body"!=a)return scheduler._on_mouse_down(e,t.parentNode);this._drag_mode=null,this._drag_id=null}if(this._drag_mode){var n=this._locate_event(t);if(this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[n,this._drag_mode,e])){
if(this._drag_id=n,(this._edit_id!=this._drag_id||this._edit_id&&"create"==this._drag_mode)&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=scheduler._lame_clone(this.getEvent(this._drag_id)||{}),this._drag_pos=this._mouse_coords(e),this._drag_pos.start=+new Date}else this._drag_mode=this._drag_id=0}this._drag_start=null}},scheduler._get_private_properties=function(e){var t={};for(var a in e)0===a.indexOf("_")&&(t[a]=!0);return t},scheduler._clear_temporary_properties=function(e,t){
var a=this._get_private_properties(e),n=this._get_private_properties(t);for(var i in n)a[i]||delete t[i]},scheduler._on_mouse_up=function(e){if(!e||2!=e.button||!scheduler.config.touch){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var t=this._drag_id,a=this._drag_mode,n=this.getEvent(this._drag_id);if(this._drag_event._dhx_changed||!this._drag_event.start_date||n.start_date.valueOf()!=this._drag_event.start_date.valueOf()||n.end_date.valueOf()!=this._drag_event.end_date.valueOf()){
var i="new-size"==this._drag_mode;if(this.callEvent("onBeforeEventChanged",[n,e,i,this._drag_event]))if(this._drag_id=this._drag_mode=null,i&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select)return scheduler.callEvent("onDragEnd",[t,a,e]),this.showLightbox(t);this._drag_pos=!0,this._select_id=this._edit_id=t}else this._new_event||this.callEvent(i?"onEventAdded":"onEventChanged",[t,this.getEvent(t)]);else i?this.deleteEvent(n.id,!0):(this._drag_event._dhx_changed=!1,
this._clear_temporary_properties(n,this._drag_event),scheduler._lame_copy(n,this._drag_event),this.updateEvent(n.id))}this._drag_pos&&(this._drag_pos.has_moved||this._drag_pos===!0)&&this.render_view_data(),scheduler.callEvent("onDragEnd",[t,a,e])}this._drag_id=null,this._drag_mode=null,this._drag_pos=null}},scheduler._trigger_dyn_loading=function(){return this._load_mode&&this._load()?(this._render_wait=!0,!0):!1},scheduler.update_view=function(){var e=this[this._mode+"_view"];return e?e(!0):this._reset_scale(),
this._trigger_dyn_loading()?!0:void this.render_view_data()},scheduler.isViewExists=function(e){return!!(scheduler[e+"_view"]||scheduler.date[e+"_start"]&&scheduler.templates[e+"_date"]&&scheduler.templates[e+"_scale_date"])},scheduler.updateView=function(e,t){e=e||this._date,t=t||this._mode;var a="dhx_cal_data";this._mode?this._obj.className=this._obj.className.replace("dhx_scheduler_"+this._mode,"dhx_scheduler_"+t):this._obj.className+=" dhx_scheduler_"+t;var n=this._mode==t&&this.config.preserve_scroll?this._els[a][0].scrollTop:!1;

this[this._mode+"_view"]&&t&&this._mode!=t&&this[this._mode+"_view"](!1),this._close_not_saved();var i="dhx_multi_day";this._els[i]&&(this._els[i][0].parentNode.removeChild(this._els[i][0]),this._els[i]=null),this._mode=t,this._date=e,this._table_view="month"==this._mode,this._dy_shift=0;var r=this._els.dhx_cal_tab;if(r)for(var s=0;s<r.length;s++){var d=r[s].className;d=d.replace(/ active/g,""),r[s].getAttribute("name")==this._mode+"_tab"&&(d+=" active"),r[s].className=d}this.update_view(),"number"==typeof n&&(this._els[a][0].scrollTop=n);

},scheduler.setCurrentView=function(e,t){this.callEvent("onBeforeViewChange",[this._mode,this._date,t||this._mode,e||this._date])&&(this.updateView(e,t),this.callEvent("onViewChange",[this._mode,this._date]))},scheduler._render_x_header=function(e,t,a,n,i){i=i||0;var r=document.createElement("DIV");r.className="dhx_scale_bar",this.templates[this._mode+"_scalex_class"]&&(r.className+=" "+this.templates[this._mode+"_scalex_class"](a));var s=this._cols[e]-1;"month"==this._mode&&0===e&&this.config.left_border&&(r.className+=" dhx_scale_bar_border",
t+=1),this.set_xy(r,s,this.xy.scale_height-2,t,i),r.innerHTML=this.templates[this._mode+"_scale_date"](a,this._mode),n.appendChild(r)},scheduler._get_columns_num=function(e,t){var a=7;if(!scheduler._table_view){var n=scheduler.date["get_"+scheduler._mode+"_end"];n&&(t=n(e)),a=Math.round((t.valueOf()-e.valueOf())/864e5)}return a},scheduler._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},scheduler._get_view_end=function(){var e=this._get_timeunit_start(),t=scheduler.date.add(e,1,this._mode);

if(!scheduler._table_view){var a=scheduler.date["get_"+scheduler._mode+"_end"];a&&(t=a(e))}return t},scheduler._calc_scale_sizes=function(e,t,a){var n=e,i=this._get_columns_num(t,a);this._process_ignores(t,i,"day",1);for(var r=i-this._ignores_detected,s=0;i>s;s++)this._ignores[s]?(this._cols[s]=0,r++):this._cols[s]=Math.floor(n/(r-s)),n-=this._cols[s],this._colsS[s]=(this._cols[s-1]||0)+(this._colsS[s-1]||(this._table_view?0:this.xy.scale_width+2));this._colsS.col_length=i,this._colsS[i]=this._cols[i-1]+this._colsS[i-1]||0;

},scheduler._set_scale_col_size=function(e,t,a){var n=this.config;this.set_xy(e,t-1,n.hour_size_px*(n.last_hour-n.first_hour),a+this.xy.scale_width+1,0)},scheduler._render_scales=function(e,t){var a=new Date(scheduler._min_date),n=new Date(scheduler._max_date),i=this.date.date_part(scheduler._currentDate()),r=parseInt(e.style.width,10),s=new Date(this._min_date),d=this._get_columns_num(a,n);this._calc_scale_sizes(r,a,n);var o=0;e.innerHTML="";for(var _=0;d>_;_++){if(this._ignores[_]||this._render_x_header(_,o,s,e),
!this._table_view){var l=document.createElement("DIV"),h="dhx_scale_holder";s.valueOf()==i.valueOf()&&(h="dhx_scale_holder_now"),this._ignores_detected&&this._ignores[_]&&(h+=" dhx_scale_ignore"),l.className=h+" "+this.templates.week_date_class(s,i),this._set_scale_col_size(l,this._cols[_],o),t.appendChild(l),this.callEvent("onScaleAdd",[l,s])}o+=this._cols[_],s=this.date.add(s,1,"day"),s=this.date.day_start(s)}},scheduler._reset_scale=function(){if(this.templates[this._mode+"_date"]){var e=this._els.dhx_cal_header[0],t=this._els.dhx_cal_data[0],a=this.config;

e.innerHTML="",t.innerHTML="";var n=(a.readonly||!a.drag_resize?" dhx_resize_denied":"")+(a.readonly||!a.drag_move?" dhx_move_denied":"");t.className="dhx_cal_data"+n,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes();var i,r,s=this._get_timeunit_start(),d=scheduler._get_view_end();if(i=r=this._table_view?scheduler.date.week_start(s):s,this._min_date=i,this._els.dhx_cal_date[0].innerHTML=this.templates[this._mode+"_date"](s,d,this._mode),this._max_date=d,scheduler._render_scales(e,t),
this._table_view)this._reset_month_scale(t,s,r);else if(this._reset_hours_scale(t,s,r),a.multi_day){var o="dhx_multi_day";this._els[o]&&(this._els[o][0].parentNode.removeChild(this._els[o][0]),this._els[o]=null);var _=this._els.dhx_cal_navline[0],l=_.offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,h=document.createElement("DIV");h.className=o,h.style.visibility="hidden",this.set_xy(h,Math.max(this._colsS[this._colsS.col_length]+this.xy.scroll_width-2,0),0,0,l),t.parentNode.insertBefore(h,t);

var c=h.cloneNode(!0);c.className=o+"_icon",c.style.visibility="hidden",this.set_xy(c,this.xy.scale_width,0,0,l),h.appendChild(c),this._els[o]=[h,c],this._els[o][0].onclick=this._click.dhx_cal_data}}},scheduler._reset_hours_scale=function(e,t,a){var n=document.createElement("DIV");n.className="dhx_scale_holder";for(var i=new Date(1980,1,1,this.config.first_hour,0,0),r=1*this.config.first_hour;r<this.config.last_hour;r++){var s=document.createElement("DIV");s.className="dhx_scale_hour",s.style.height=this.config.hour_size_px-(this._quirks?0:1)+"px";

var d=this.xy.scale_width;this.config.left_border&&(d-=1,s.className+=" dhx_scale_hour_border"),s.style.width=d+"px",s.innerHTML=scheduler.templates.hour_scale(i),n.appendChild(s),i=this.date.add(i,1,"hour")}e.appendChild(n),this.config.scroll_hour&&(e.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},scheduler._currentDate=function(){return scheduler.config.now_date?new Date(scheduler.config.now_date):new Date},scheduler._process_ignores=function(e,t,a,n,i){this._ignores={},
this._ignores_detected=0;var r=scheduler["ignore_"+this._mode];if(r)for(var s=new Date(e),d=0;t>d;d++)r(s)&&(this._ignores_detected+=1,this._ignores[d]=!0,i&&t++),s=scheduler.date.add(s,n,a),scheduler.date[a+"_start"]&&(s=scheduler.date[a+"_start"](s))},scheduler._render_month_scale=function(e,t,a){function n(e){var t=scheduler._colsS.height;return void 0!==scheduler._colsS.heights[e+1]&&(t=scheduler._colsS.heights[e+1]-(scheduler._colsS.heights[e]||0)),t}var i=scheduler.date.add(t,1,"month"),r=new Date(a),s=scheduler._currentDate();

this.date.date_part(s),this.date.date_part(a);for(var d=Math.ceil(Math.round((i.valueOf()-a.valueOf())/864e5)/7),o=[],_=0;7>=_;_++){var l=(this._cols[_]||0)-1;0===_&&this.config.left_border&&(l-=1),o[_]=" style='width:"+l+"px;"}for(var h=0,c="<table cellpadding='0' cellspacing='0'>",u=[],_=0;d>_;_++){c+="<tr>";for(var v=Math.max(n(_)-scheduler.xy.month_head_height,0),f=0;7>f;f++){c+="<td";var g="";t>a?g="dhx_before":a>=i?g="dhx_after":a.valueOf()==s.valueOf()&&(g="dhx_now"),this._ignores_detected&&this._ignores[f]&&(g+=" dhx_scale_ignore"),
c+=" class='"+g+" "+this.templates.month_date_class(a,s)+"' >";var m="dhx_month_body",p="dhx_month_head";0===f&&this.config.left_border&&(m+=" dhx_month_body_border",p+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[f]?c+="<div></div><div></div>":(c+="<div class='"+p+"'>"+this.templates.month_day(a)+"</div>",c+="<div class='"+m+"' "+o[f]+";height:"+v+"px;'></div></td>"),u.push(a);var x=a.getDate();a=this.date.add(a,1,"day"),a.getDate()-x>1&&(a=new Date(a.getFullYear(),a.getMonth(),x+1,12,0));

}c+="</tr>",scheduler._colsS.heights[_]=h,h+=n(_)}c+="</table>",this._min_date=r,this._max_date=a,e.innerHTML=c,this._scales={};for(var y=e.getElementsByTagName("div"),_=0;_<u.length;_++){var e=y[2*_+1],b=u[_];this._scales[+b]=e}for(var _=0;_<u.length;_++){var b=u[_];this.callEvent("onScaleAdd",[this._scales[+b],b])}return this._max_date},scheduler._reset_month_scale=function(e,t,a){var n=scheduler.date.add(t,1,"month"),i=scheduler._currentDate();this.date.date_part(i),this.date.date_part(a);var r=Math.ceil(Math.round((n.valueOf()-a.valueOf())/864e5)/7),s=Math.floor(e.clientHeight/r)-this.xy.month_head_height;

return this._colsS.height=s+this.xy.month_head_height,this._colsS.heights=[],scheduler._render_month_scale(e,t,a)},scheduler.getLabel=function(e,t){for(var a=this.config.lightbox.sections,n=0;n<a.length;n++)if(a[n].map_to==e)for(var i=a[n].options,r=0;r<i.length;r++)if(i[r].key==t)return i[r].label;return""},scheduler.updateCollection=function(e,t){var a=scheduler.serverList(e);return a?(a.splice(0,a.length),a.push.apply(a,t||[]),scheduler.callEvent("onOptionsLoad",[]),scheduler.resetLightbox(),!0):!1;

},scheduler._lame_clone=function(e,t){var a,n,i;for(t=t||[],a=0;a<t.length;a+=2)if(e===t[a])return t[a+1];if(e&&"object"==typeof e){for(i={},n=[Array,Date,Number,String,Boolean],a=0;a<n.length;a++)e instanceof n[a]&&(i=a?new n[a](e):new n[a]);t.push(e,i);for(a in e)Object.prototype.hasOwnProperty.apply(e,[a])&&(i[a]=scheduler._lame_clone(e[a],t))}return i||e},scheduler._lame_copy=function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e},scheduler._get_date_from_pos=function(e){var t=this._min_date.valueOf()+6e4*(e.y*this.config.time_step+24*(this._table_view?0:e.x)*60);

return new Date(this._correct_shift(t))},scheduler.getActionData=function(e){var t=this._mouse_coords(e);return{date:this._get_date_from_pos(t),section:t.section}},scheduler._focus=function(e,t){e&&e.focus&&(this.config.touch?window.setTimeout(function(){e.focus()},100):(t&&e.select&&e.select(),e.focus()))},scheduler._get_real_event_length=function(e,t,a){var n,i=t-e,r=a._start_correction+a._end_correction||0,s=this["ignore_"+this._mode],d=0;for(a.render?(d=this._get_date_index(a,e),n=this._get_date_index(a,t)):n=Math.round(i/60/60/1e3/24);n>d;){
var o=scheduler.date.add(t,-a.x_step,a.x_unit);i-=s&&s(t)?t-o:r,t=o,n--}return i},scheduler._get_fictional_event_length=function(e,t,a,n){var i=new Date(e),r=n?-1:1;if(a._start_correction||a._end_correction){var s;s=n?60*i.getHours()+i.getMinutes()-60*(a.first_hour||0):60*(a.last_hour||0)-(60*i.getHours()+i.getMinutes());var d=60*(a.last_hour-a.first_hour),o=Math.ceil((t/6e4-s)/d);t+=o*(1440-d)*60*1e3}var _,l=new Date(1*e+t*r),h=this["ignore_"+this._mode],c=0;for(a.render?(c=this._get_date_index(a,i),
_=this._get_date_index(a,l)):_=Math.round(t/60/60/1e3/24);_*r>=c*r;){var u=scheduler.date.add(i,a.x_step*r,a.x_unit);h&&h(i)&&(t+=(u-i)*r,_+=r),i=u,c+=r}return t},scheduler._get_section_view=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode]:this._props&&this._props[this._mode]?this._props[this._mode]:null},scheduler._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null;

},scheduler._is_initialized=function(){var e=this.getState();return this._obj&&e.date&&e.mode},scheduler._is_lightbox_open=function(){var e=this.getState();return null!==e.lightbox_id&&void 0!==e.lightbox_id},scheduler.date={init:function(){for(var e=scheduler.locale.date.month_short,t=scheduler.locale.date.month_short_hash={},a=0;a<e.length;a++)t[e[a]]=a;for(var e=scheduler.locale.date.month_full,t=scheduler.locale.date.month_full_hash={},a=0;a<e.length;a++)t[e[a]]=a},_bind_host_object:function(e){
return e.bind?e.bind(scheduler):function(){return e.apply(scheduler,arguments)}},date_part:function(e){var t=new Date(e);return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.getHours()&&(e.getDate()<t.getDate()||e.getMonth()<t.getMonth()||e.getFullYear()<t.getFullYear())&&e.setTime(e.getTime()+36e5*(24-e.getHours())),e},time_part:function(e){return(e.valueOf()/1e3-60*e.getTimezoneOffset())%86400},week_start:function(e){var t=e.getDay();return scheduler.config.start_on_monday&&(0===t?t=6:t--),
this.date_part(this.add(e,-1*t,"day"))},month_start:function(e){return e.setDate(1),this.date_part(e)},year_start:function(e){return e.setMonth(0),this.month_start(e)},day_start:function(e){return this.date_part(e)},_add_days:function(e,t){var a=new Date(e.valueOf());return a.setDate(a.getDate()+t),t>=0&&!e.getHours()&&a.getHours()&&(a.getDate()<e.getDate()||a.getMonth()<e.getMonth()||a.getFullYear()<e.getFullYear())&&a.setTime(a.getTime()+36e5*(24-a.getHours())),a},add:function(e,t,a){var n=new Date(e.valueOf());

switch(a){case"day":n=scheduler.date._add_days(n,t);break;case"week":n=scheduler.date._add_days(n,7*t);break;case"month":n.setMonth(n.getMonth()+t);break;case"year":n.setYear(n.getFullYear()+t);break;case"hour":n.setTime(n.getTime()+60*t*60*1e3);break;case"minute":n.setTime(n.getTime()+60*t*1e3);break;default:return scheduler.date["add_"+a](e,t,a)}return n},to_fixed:function(e){return 10>e?"0"+e:e},copy:function(e){return new Date(e.valueOf())},date_to_str:function(e,t){e=e.replace(/%[a-zA-Z]/g,function(e){
switch(e){case"%d":return'"+this.date.to_fixed(date.getDate())+"';case"%m":return'"+this.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+this.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+this.locale.date.day_short[date.getDay()]+"';case"%l":return'"+this.locale.date.day_full[date.getDay()]+"';case"%M":return'"+this.locale.date.month_short[date.getMonth()]+"';case"%F":
return'"+this.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+this.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+this.date.to_fixed(date.getHours())+"';case"%i":return'"+this.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+this.date.to_fixed(date.getSeconds())+"';case"%W":return'"+this.date.to_fixed(this.date.getISOWeek(date))+"';

default:return e}}),t&&(e=e.replace(/date\.get/g,"date.getUTC"));var a=new Function("date",'return "'+e+'";');return scheduler.date._bind_host_object(a)},str_to_date:function(e,t){for(var a="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",n=e.match(/%[a-zA-Z]/g),i=0;i<n.length;i++)switch(n[i]){case"%j":case"%d":a+="set[2]=temp["+i+"]||1;";break;case"%n":case"%m":a+="set[1]=(temp["+i+"]||1)-1;";break;case"%y":a+="set[0]=temp["+i+"]*1+(temp["+i+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":
a+="set[3]=temp["+i+"]||0;";break;case"%i":a+="set[4]=temp["+i+"]||0;";break;case"%Y":a+="set[0]=temp["+i+"]||0;";break;case"%a":case"%A":a+="set[3]=set[3]%12+((temp["+i+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":a+="set[5]=temp["+i+"]||0;";break;case"%M":a+="set[1]=this.locale.date.month_short_hash[temp["+i+"]]||0;";break;case"%F":a+="set[1]=this.locale.date.month_full_hash[temp["+i+"]]||0;"}var r="set[0],set[1],set[2],set[3],set[4],set[5]";t&&(r=" Date.UTC("+r+")");var s=new Function("date","var set=[0,0,1,0,0,0]; "+a+" return new Date("+r+");");

return scheduler.date._bind_host_object(s)},getISOWeek:function(e){if(!e)return!1;var t=e.getDay();0===t&&(t=7);var a=new Date(e.valueOf());a.setDate(e.getDate()+(4-t));var n=a.getFullYear(),i=Math.round((a.getTime()-new Date(n,0,1).getTime())/864e5),r=1+Math.floor(i/7);return r},getUTCISOWeek:function(e){return this.getISOWeek(this.convert_to_utc(e))},convert_to_utc:function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}
},scheduler.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",
icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",
description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel"}},scheduler.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%m/%d/%Y %H:%i",api_date:"%d-%m-%Y %H:%i",preserve_length:!0,time_step:5,start_on_monday:1,first_hour:0,last_hour:24,readonly:!1,drag_resize:1,drag_move:1,
drag_create:1,dblclick_create:1,edit_on_create:1,details_on_create:0,resize_month_events:!1,resize_month_timed:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],
buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",height:200,map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0},scheduler.templates={},scheduler.init_templates=function(){var e=scheduler.locale.labels;e.dhx_save_btn=e.icon_save,e.dhx_cancel_btn=e.icon_cancel,e.dhx_delete_btn=e.icon_delete;var t=scheduler.date.date_to_str,a=scheduler.config,n=function(e,t){
for(var a in t)e[a]||(e[a]=t[a])};n(scheduler.templates,{day_date:t(a.default_date),month_date:t(a.month_date),week_date:function(e,t){return scheduler.templates.day_date(e)+" &ndash; "+scheduler.templates.day_date(scheduler.date.add(t,-1,"day"))},day_scale_date:t(a.default_date),month_scale_date:t(a.week_date),week_scale_date:t(a.day_date),hour_scale:t(a.hour_date),time_picker:t(a.hour_date),event_date:t(a.hour_date),month_day:t(a.month_day),xml_date:scheduler.date.str_to_date(a.xml_date,a.server_utc),
load_format:t(a.load_date,a.server_utc),xml_format:t(a.xml_date,a.server_utc),api_date:scheduler.date.str_to_date(a.api_date),event_header:function(e,t,a){return scheduler.templates.event_date(e)+" - "+scheduler.templates.event_date(t)},event_text:function(e,t,a){return a.text},event_class:function(e,t,a){return""},month_date_class:function(e){return""},week_date_class:function(e){return""},event_bar_date:function(e,t,a){return scheduler.templates.event_date(e)+" "},event_bar_text:function(e,t,a){
return a.text},month_events_link:function(e,t){return"<a>View more("+t+" events)</a>"},drag_marker_class:function(e,t,a){return""},drag_marker_content:function(e,t,a){return""}}),this.callEvent("onTemplatesReady",[])},scheduler.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++},scheduler._events={},scheduler.clearAll=function(){this._events={},this._loaded={},this._edit_id=null,this._select_id=null,this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this.clear_view(),
this.callEvent("onClearAll",[])},scheduler.addEvent=function(e,t,a,n,i){if(!arguments.length)return this.addEventNow();var r=e;1!=arguments.length&&(r=i||{},r.start_date=e,r.end_date=t,r.text=a,r.id=n),r.id=r.id||scheduler.uid(),r.text=r.text||"","string"==typeof r.start_date&&(r.start_date=this.templates.api_date(r.start_date)),"string"==typeof r.end_date&&(r.end_date=this.templates.api_date(r.end_date));var s=6e4*(this.config.event_duration||this.config.time_step);r.start_date.valueOf()==r.end_date.valueOf()&&r.end_date.setTime(r.end_date.valueOf()+s),
r._timed=this.isOneDayEvent(r);var d=!this._events[r.id];return this._events[r.id]=r,this.event_updated(r),this._loading||this.callEvent(d?"onEventAdded":"onEventChanged",[r.id,r]),r.id},scheduler.deleteEvent=function(e,t){var a=this._events[e];(t||this.callEvent("onBeforeEventDelete",[e,a])&&this.callEvent("onConfirmedBeforeEventDelete",[e,a]))&&(a&&(this._select_id=null,delete this._events[e],this.event_updated(a)),this.callEvent("onEventDeleted",[e,a]))},scheduler.getEvent=function(e){return this._events[e];

},scheduler.setEvent=function(e,t){t.id||(t.id=e),this._events[e]=t},scheduler.for_rendered=function(e,t){for(var a=this._rendered.length-1;a>=0;a--)this._rendered[a].getAttribute("event_id")==e&&t(this._rendered[a],a)},scheduler.changeEventId=function(e,t){if(e!=t){var a=this._events[e];a&&(a.id=t,this._events[t]=a,delete this._events[e]),this.for_rendered(e,function(e){e.setAttribute("event_id",t)}),this._select_id==e&&(this._select_id=t),this._edit_id==e&&(this._edit_id=t),this.callEvent("onEventIdChange",[e,t]);

}},function(){for(var e=["text","Text","start_date","StartDate","end_date","EndDate"],t=function(e){return function(t){return scheduler.getEvent(t)[e]}},a=function(e){return function(t,a){var n=scheduler.getEvent(t);n[e]=a,n._changed=!0,n._timed=this.isOneDayEvent(n),scheduler.event_updated(n,!0)}},n=0;n<e.length;n+=2)scheduler["getEvent"+e[n+1]]=t(e[n]),scheduler["setEvent"+e[n+1]]=a(e[n])}(),scheduler.event_updated=function(e,t){this.is_visible_events(e)?this.render_view_data():this.clear_event(e.id);

},scheduler.is_visible_events=function(e){var t=e.start_date<this._max_date&&this._min_date<e.end_date;if(t){var a=this._table_view||e.end_date.getHours()>=this.config.first_hour&&e.end_date.getHours()<this.config.last_hour||e.start_date.getHours()>=this.config.first_hour&&e.start_date.getHours()<this.config.last_hour;if(a)return!0;var n=(e.end_date.valueOf()-e.start_date.valueOf())/36e5,i=24-(this.config.last_hour-this.config.first_hour);return n>i}return!1},scheduler.isOneDayEvent=function(e){var t=e.end_date.getDate()-e.start_date.getDate();

return t?(0>t&&(t=Math.ceil((e.end_date.valueOf()-e.start_date.valueOf())/864e5)),1==t&&!e.end_date.getHours()&&!e.end_date.getMinutes()&&(e.start_date.getHours()||e.start_date.getMinutes())):e.start_date.getMonth()==e.end_date.getMonth()&&e.start_date.getFullYear()==e.end_date.getFullYear()},scheduler.get_visible_events=function(e){var t=[];for(var a in this._events)this.is_visible_events(this._events[a])&&(!e||this._events[a]._timed)&&this.filter_event(a,this._events[a])&&t.push(this._events[a]);

return t},scheduler.filter_event=function(e,t){var a=this["filter_"+this._mode];return a?a(e,t):!0},scheduler._is_main_area_event=function(e){return!!e._timed},scheduler.render_view_data=function(e,t){if(!e){if(this._not_render)return void(this._render_wait=!0);this._render_wait=!1,this.clear_view(),e=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(var a=0,n=e.length;n>a;a++)this._recalculate_timed(e[a]);if(this.config.multi_day&&!this._table_view){for(var i=[],r=[],a=0;a<e.length;a++)this._is_main_area_event(e[a])?i.push(e[a]):r.push(e[a]);

this._rendered_location=this._els.dhx_multi_day[0],this._table_view=!0,this.render_data(r,t),this._table_view=!1,this._rendered_location=this._els.dhx_cal_data[0],this._table_view=!1,this.render_data(i,t)}else this._rendered_location=this._els.dhx_cal_data[0],this.render_data(e,t)},scheduler._view_month_day=function(e){var t=scheduler.getActionData(e).date;scheduler.callEvent("onViewMoreClick",[t])&&scheduler.setCurrentView(t,"day")},scheduler._render_month_link=function(e){for(var t=this._rendered_location,a=this._lame_clone(e),n=e._sday;n<e._eday;n++){
a._sday=n,a._eday=n+1;var i=scheduler.date,r=scheduler._min_date;r=i.add(r,a._sweek,"week"),r=i.add(r,a._sday,"day");var s=scheduler.getEvents(r,i.add(r,1,"day")).length,d=this._get_event_bar_pos(a),o=d.x2-d.x,_=document.createElement("div");_.onclick=function(e){scheduler._view_month_day(e||event)},_.className="dhx_month_link",_.style.top=d.y+"px",_.style.left=d.x+"px",_.style.width=o+"px",_.innerHTML=scheduler.templates.month_events_link(r,s),this._rendered.push(_),t.appendChild(_)}},scheduler._recalculate_timed=function(e){
if(e){var t;t="object"!=typeof e?this._events[e]:e,t&&(t._timed=scheduler.isOneDayEvent(t))}},scheduler.attachEvent("onEventChanged",scheduler._recalculate_timed),scheduler.attachEvent("onEventAdded",scheduler._recalculate_timed),scheduler.render_data=function(e,t){e=this._pre_render_events(e,t);for(var a=0;a<e.length;a++)if(this._table_view)if("month"!=scheduler._mode)this.render_event_bar(e[a]);else{var n=scheduler.config.max_month_events;n!==1*n||e[a]._sorder<n?this.render_event_bar(e[a]):void 0!==n&&e[a]._sorder==n&&scheduler._render_month_link(e[a]);

}else this.render_event(e[a])},scheduler._get_first_visible_cell=function(e){for(var t=0;t<e.length;t++)if(-1==(e[t].className||"").indexOf("dhx_scale_ignore"))return e[t];return e[0]},scheduler._pre_render_events=function(e,t){var a=this.xy.bar_height,n=this._colsS.heights,i=this._colsS.heights=[0,0,0,0,0,0,0],r=this._els.dhx_cal_data[0];if(e=this._table_view?this._pre_render_events_table(e,t):this._pre_render_events_line(e,t),this._table_view)if(t)this._colsS.heights=n;else{var s=r.firstChild;if(s.rows){
for(var d=0;d<s.rows.length;d++){i[d]++;var o=s.rows[d].cells,_=this._colsS.height-this.xy.month_head_height;if(i[d]*a>_){var l=_;1*this.config.max_month_events!==this.config.max_month_events||i[d]<=this.config.max_month_events?l=i[d]*a:(this.config.max_month_events+1)*a>_&&(l=(this.config.max_month_events+1)*a);for(var h=0;h<o.length;h++)o[h].childNodes[1].style.height=l+"px"}i[d]=(i[d-1]||0)+scheduler._get_first_visible_cell(o).offsetHeight}if(i.unshift(0),s.parentNode.offsetHeight<s.parentNode.scrollHeight&&!scheduler._colsS.scroll_fix&&scheduler.xy.scroll_width){
var c=scheduler._colsS,u=c[c.col_length],v=c.heights.slice();u-=scheduler.xy.scroll_width||0,this._calc_scale_sizes(u,this._min_date,this._max_date),scheduler._colsS.heights=v,this.set_xy(this._els.dhx_cal_header[0],u,this.xy.scale_height),scheduler._render_scales(this._els.dhx_cal_header[0]),scheduler._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date),c.scroll_fix=!0}}else if(e.length||"visible"!=this._els.dhx_multi_day[0].style.visibility||(i[0]=-1),e.length||-1==i[0]){
var f=(s.parentNode.childNodes,(i[0]+1)*a+1),g=f,m=f+"px";this.config.multi_day_height_limit&&(g=Math.min(f,this.config.multi_day_height_limit),m=g+"px"),r.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+g+"px",r.style.height=this._obj.offsetHeight-parseInt(r.style.top,10)-(this.xy.margin_top||0)+"px";var p=this._els.dhx_multi_day[0];p.style.height=m,p.style.visibility=-1==i[0]?"hidden":"visible";var x=this._els.dhx_multi_day[1];x.style.height=m,x.style.visibility=-1==i[0]?"hidden":"visible",
x.className=i[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(i[0]+1)*a,this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift)),i[0]=0,g!=f&&(r.style.top=parseInt(r.style.top)+2+"px",p.style.overflowY="auto",x.style.position="fixed",x.style.top="",x.style.left="")}}return e},scheduler._get_event_sday=function(e){return Math.floor((e.start_date.valueOf()-this._min_date.valueOf())/864e5)},scheduler._get_event_mapped_end_date=function(e){
var t=e.end_date;if(this.config.separate_short_events){var a=(e.end_date-e.start_date)/6e4;a<this._min_mapped_duration&&(t=this.date.add(t,this._min_mapped_duration-a,"minute"))}return t},scheduler._pre_render_events_line=function(e,t){e.sort(function(e,t){return e.start_date.valueOf()==t.start_date.valueOf()?e.id>t.id?1:-1:e.start_date>t.start_date?1:-1});var a=[],n=[];this._min_mapped_duration=Math.ceil(60*this.xy.min_event_height/this.config.hour_size_px);for(var i=0;i<e.length;i++){var r=e[i],s=r.start_date,d=r.end_date,o=s.getHours(),_=d.getHours();

if(r._sday=this._get_event_sday(r),this._ignores[r._sday])e.splice(i,1),i--;else{if(a[r._sday]||(a[r._sday]=[]),!t){r._inner=!1;for(var l=a[r._sday];l.length;){var h=l[l.length-1],c=this._get_event_mapped_end_date(h);if(!(c.valueOf()<=r.start_date.valueOf()))break;l.splice(l.length-1,1)}for(var u=l.length,v=!1,f=0;f<l.length;f++){var h=l[f],c=this._get_event_mapped_end_date(h);if(c.valueOf()<=r.start_date.valueOf()){v=!0,r._sorder=h._sorder,u=f,r._inner=!0;break}}if(l.length&&(l[l.length-1]._inner=!0),
!v)if(l.length)if(l.length<=l[l.length-1]._sorder){if(l[l.length-1]._sorder)for(f=0;f<l.length;f++){for(var g=!1,m=0;m<l.length;m++)if(l[m]._sorder==f){g=!0;break}if(!g){r._sorder=f;break}}else r._sorder=0;r._inner=!0}else{var p=l[0]._sorder;for(f=1;f<l.length;f++)l[f]._sorder>p&&(p=l[f]._sorder);r._sorder=p+1,r._inner=!1}else r._sorder=0;l.splice(u,u==l.length?0:1,r),l.length>(l.max_count||0)?(l.max_count=l.length,r._count=l.length):r._count=r._count?r._count:1}(o<this.config.first_hour||_>=this.config.last_hour)&&(n.push(r),
e[i]=r=this._copy_event(r),o<this.config.first_hour&&(r.start_date.setHours(this.config.first_hour),r.start_date.setMinutes(0)),_>=this.config.last_hour&&(r.end_date.setMinutes(0),r.end_date.setHours(this.config.last_hour)),r.start_date>r.end_date||o==this.config.last_hour)&&(e.splice(i,1),i--)}}if(!t){for(var i=0;i<e.length;i++)e[i]._count=a[e[i]._sday].max_count;for(var i=0;i<n.length;i++)n[i]._count=a[n[i]._sday].max_count}return e},scheduler._time_order=function(e){e.sort(function(e,t){return e.start_date.valueOf()==t.start_date.valueOf()?e._timed&&!t._timed?1:!e._timed&&t._timed?-1:e.id>t.id?1:-1:e.start_date>t.start_date?1:-1;

})},scheduler._pre_render_events_table=function(e,t){this._time_order(e);for(var a,n=[],i=[[],[],[],[],[],[],[]],r=this._colsS.heights,s=this._cols.length,d={},o=0;o<e.length;o++){var _=e[o],l=_.id;d[l]||(d[l]={first_chunk:!0,last_chunk:!0});var h=d[l],c=a||_.start_date,u=_.end_date;c<this._min_date&&(h.first_chunk=!1,c=this._min_date),u>this._max_date&&(h.last_chunk=!1,u=this._max_date);var v=this.locate_holder_day(c,!1,_);if(_._sday=v%s,!this._ignores[_._sday]||!_._timed){var f=this.locate_holder_day(u,!0,_)||s;

_._eday=f%s||s,_._length=f-v,_._sweek=Math.floor((this._correct_shift(c.valueOf(),1)-this._min_date.valueOf())/(864e5*s));var g,m=i[_._sweek];for(g=0;g<m.length&&!(m[g]._eday<=_._sday);g++);if(_._sorder&&t||(_._sorder=g),_._sday+_._length<=s)a=null,n.push(_),m[g]=_,r[_._sweek]=m.length-1,_._first_chunk=h.first_chunk,_._last_chunk=h.last_chunk;else{var p=this._copy_event(_);p.id=_.id,p._length=s-_._sday,p._eday=s,p._sday=_._sday,p._sweek=_._sweek,p._sorder=_._sorder,p.end_date=this.date.add(c,p._length,"day"),
p._first_chunk=h.first_chunk,h.first_chunk&&(h.first_chunk=!1),n.push(p),m[g]=p,a=p.end_date,r[_._sweek]=m.length-1,o--}}}return n},scheduler._copy_dummy=function(){var e=new Date(this.start_date),t=new Date(this.end_date);this.start_date=e,this.end_date=t},scheduler._copy_event=function(e){return this._copy_dummy.prototype=e,new this._copy_dummy},scheduler._rendered=[],scheduler.clear_view=function(){for(var e=0;e<this._rendered.length;e++){var t=this._rendered[e];t.parentNode&&t.parentNode.removeChild(t);

}this._rendered=[]},scheduler.updateEvent=function(e){var t=this.getEvent(e);this.clear_event(e),t&&this.is_visible_events(t)&&this.filter_event(e,t)&&(this._table_view||this.config.multi_day||t._timed)&&(this.config.update_render?this.render_view_data():"month"!=this.getState().mode||this.getState().drag_id||this.isOneDayEvent(t)?this.render_view_data([t],!0):this.render_view_data())},scheduler.clear_event=function(e){this.for_rendered(e,function(e,t){e.parentNode&&e.parentNode.removeChild(e),scheduler._rendered.splice(t,1);

})},scheduler._y_from_date=function(e){var t=60*e.getHours()+e.getMinutes();return Math.round((60*t*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)},scheduler._calc_event_y=function(e,t){t=t||0;var a=60*e.start_date.getHours()+e.start_date.getMinutes(),n=60*e.end_date.getHours()+e.end_date.getMinutes()||60*scheduler.config.last_hour,i=this._y_from_date(e.start_date),r=Math.max(t,(n-a)*this.config.hour_size_px/60);return{top:i,height:r}},scheduler.render_event=function(e){
var t=scheduler.xy.menu_width,a=this.config.use_select_menu_space?0:t;if(!(e._sday<0)){var n=scheduler.locate_holder(e._sday);if(n){var i=this._calc_event_y(e,scheduler.xy.min_event_height),r=i.top,s=i.height,d=e._count||1,o=e._sorder||0,_=Math.floor((n.clientWidth-a)/d),l=o*_+1;if(e._inner||(_*=d-o),this.config.cascade_event_display){var h=this.config.cascade_event_count,c=this.config.cascade_event_margin;l=o%h*c;var u=e._inner?(d-o-1)%h*c/2:0;_=Math.floor(n.clientWidth-a-l-u)}var v=this._render_v_bar(e,a+l,r,_,s,e._text_style,scheduler.templates.event_header(e.start_date,e.end_date,e),scheduler.templates.event_text(e.start_date,e.end_date,e));

if(this._rendered.push(v),n.appendChild(v),l=l+parseInt(n.style.left,10)+a,this._edit_id==e.id){v.style.zIndex=1,_=Math.max(_-4,scheduler.xy.editor_width),v=document.createElement("DIV"),v.setAttribute("event_id",e.id),this.set_xy(v,_,s-20,l,r+14),v.className="dhx_cal_event dhx_cal_editor";var f=scheduler.templates.event_class(e.start_date,e.end_date,e);f&&(v.className+=" "+f);var g=document.createElement("DIV");this.set_xy(g,_-6,s-26),g.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",v.appendChild(g),
this._els.dhx_cal_data[0].appendChild(v),this._rendered.push(v),g.innerHTML="<textarea class='dhx_cal_editor'>"+e.text+"</textarea>",this._quirks7&&(g.firstChild.style.height=s-12+"px"),this._editor=g.firstChild,this._editor.onkeydown=function(e){if((e||event).shiftKey)return!0;var t=(e||event).keyCode;t==scheduler.keys.edit_save&&scheduler.editStop(!0),t==scheduler.keys.edit_cancel&&scheduler.editStop(!1)},this._editor.onselectstart=function(e){return(e||event).cancelBubble=!0,!0},scheduler._focus(g.firstChild,!0),
this._els.dhx_cal_data[0].scrollLeft=0}if(0!==this.xy.menu_width&&this._select_id==e.id){this.config.cascade_event_display&&this._drag_mode&&(v.style.zIndex=1);for(var m=this.config["icons_"+(this._edit_id==e.id?"edit":"select")],p="",x=e.color?"background-color: "+e.color+";":"",y=e.textColor?"color: "+e.textColor+";":"",b=0;b<m.length;b++)p+="<div class='dhx_menu_icon "+m[b]+"' style='"+x+y+"' title='"+this.locale.labels[m[b]]+"'></div>";var w=this._render_v_bar(e,l-t+1,r,t,20*m.length+26-2,"","<div style='"+x+y+"' class='dhx_menu_head'></div>",p,!0);

w.style.left=l-t+1,this._els.dhx_cal_data[0].appendChild(w),this._rendered.push(w)}this.config.drag_highlight&&this._drag_id==e.id&&this.highlightEventPosition(e)}}},scheduler._render_v_bar=function(e,t,a,n,i,r,s,d,o){var _=document.createElement("DIV"),l=e.id,h=o?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",c=scheduler.templates.event_class(e.start_date,e.end_date,e);c&&(h=h+" "+c);var u=e.color?"background:"+e.color+";":"",v=e.textColor?"color:"+e.textColor+";":"",f='<div event_id="'+l+'" class="'+h+'" style="position:absolute; top:'+a+"px; left:"+t+"px; width:"+(n-4)+"px; height:"+i+"px;"+(r||"")+'"></div>';

_.innerHTML=f;var g=_.cloneNode(!0).firstChild;if(!o&&scheduler.renderEvent(g,e,n,i,s,d))return g;g=_.firstChild;var m='<div class="dhx_event_move dhx_header" style=" width:'+(n-6)+"px;"+u+'" >&nbsp;</div>';m+='<div class="dhx_event_move dhx_title" style="'+u+v+'">'+s+"</div>",m+='<div class="dhx_body" style=" width:'+(n-(this._quirks?4:14))+"px; height:"+(i-(this._quirks?20:30)+1)+"px;"+u+v+'">'+d+"</div>";var p="dhx_event_resize dhx_footer";return o&&(p="dhx_resize_denied "+p),m+='<div class="'+p+'" style=" width:'+(n-8)+"px;"+(o?" margin-top:-1px;":"")+u+v+'" ></div>',
g.innerHTML=m,g},scheduler.renderEvent=function(){return!1},scheduler.locate_holder=function(e){return"day"==this._mode?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[e]},scheduler.locate_holder_day=function(e,t){var a=Math.floor((this._correct_shift(e,1)-this._min_date)/864e5);return t&&this.date.time_part(e)&&a++,a},scheduler._get_dnd_order=function(e,t,a){if(!this._drag_event)return e;this._drag_event._orig_sorder?e=this._drag_event._orig_sorder:this._drag_event._orig_sorder=e;

for(var n=t*e;n+t>a;)e--,n-=t;return e=Math.max(e,0)},scheduler._get_event_bar_pos=function(e){var t=this._colsS[e._sday],a=this._colsS[e._eday];a==t&&(a=this._colsS[e._eday+1]);var n=this.xy.bar_height,i=e._sorder;if(e.id==this._drag_id){var r=this._colsS.heights[e._sweek+1]-this._colsS.heights[e._sweek]-this.xy.month_head_height;i=scheduler._get_dnd_order(i,n,r)}var s=i*n,d=this._colsS.heights[e._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+s;return{x:t,x2:a,y:d}},scheduler.render_event_bar=function(e){
var t=this._rendered_location,a=this._get_event_bar_pos(e),n=a.y,i=a.x,r=a.x2,s="";if(r){var d=scheduler.config.resize_month_events&&"month"==this._mode&&(!e._timed||scheduler.config.resize_month_timed),o=document.createElement("DIV"),_=e.hasOwnProperty("_first_chunk")&&e._first_chunk,l=e.hasOwnProperty("_last_chunk")&&e._last_chunk,h=d&&(e._timed||_),c=d&&(e._timed||l),u="dhx_cal_event_clear";(!e._timed||d)&&(u="dhx_cal_event_line"),_&&(u+=" dhx_cal_event_line_start"),l&&(u+=" dhx_cal_event_line_end"),
h&&(s+="<div class='dhx_event_resize dhx_event_resize_start'></div>"),c&&(s+="<div class='dhx_event_resize dhx_event_resize_end'></div>");var v=scheduler.templates.event_class(e.start_date,e.end_date,e);v&&(u+=" "+v);var f=e.color?"background:"+e.color+";":"",g=e.textColor?"color:"+e.textColor+";":"",m=["position:absolute","top:"+n+"px","left:"+i+"px","width:"+(r-i-15)+"px",g,f,e._text_style||""].join(";"),p='<div event_id="'+e.id+'" class="'+u+'" style="'+m+'">';d&&(p+=s),"month"==scheduler.getState().mode&&(e=scheduler.getEvent(e.id)),
e._timed&&(p+=scheduler.templates.event_bar_date(e.start_date,e.end_date,e)),p+=scheduler.templates.event_bar_text(e.start_date,e.end_date,e)+"</div>",p+="</div>",o.innerHTML=p,this._rendered.push(o.firstChild),t.appendChild(o.firstChild)}},scheduler._locate_event=function(e){for(var t=null;e&&!t&&e.getAttribute;)t=e.getAttribute("event_id"),e=e.parentNode;return t},scheduler.edit=function(e){this._edit_id!=e&&(this.editStop(!1,e),this._edit_id=e,this.updateEvent(e))},scheduler.editStop=function(e,t){
if(!t||this._edit_id!=t){var a=this.getEvent(this._edit_id);a&&(e&&(a.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(a.id),this._edit_stop_event(a,e))}},scheduler._edit_stop_event=function(e,t){this._new_event?(t?this.callEvent("onEventAdded",[e.id,e]):e&&this.deleteEvent(e.id,!0),this._new_event=null):t&&this.callEvent("onEventChanged",[e.id,e])},scheduler.getEvents=function(e,t){var a=[];for(var n in this._events){var i=this._events[n];i&&(!e&&!t||i.start_date<t&&i.end_date>e)&&a.push(i);

}return a},scheduler.getRenderedEvent=function(e){if(e){for(var t=scheduler._rendered,a=0;a<t.length;a++){var n=t[a];if(n.getAttribute("event_id")==e)return n}return null}},scheduler.showEvent=function(e,t){var a="number"==typeof e||"string"==typeof e?scheduler.getEvent(e):e;if(t=t||scheduler._mode,a&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[a,t]))){var n=scheduler.config.scroll_hour;scheduler.config.scroll_hour=a.start_date.getHours();var i=scheduler.config.preserve_scroll;

scheduler.config.preserve_scroll=!1;var r=a.color,s=a.textColor;scheduler.config.highlight_displayed_event&&(a.color=scheduler.config.displayed_event_color,a.textColor=scheduler.config.displayed_event_text_color),scheduler.setCurrentView(new Date(a.start_date),t),a.color=r,a.textColor=s,scheduler.config.scroll_hour=n,scheduler.config.preserve_scroll=i,scheduler.matrix&&scheduler.matrix[t]&&(scheduler._els.dhx_cal_data[0].scrollTop=getAbsoluteTop(scheduler.getRenderedEvent(a.id))-getAbsoluteTop(scheduler._els.dhx_cal_data[0])-20),
scheduler.callEvent("onAfterEventDisplay",[a,t])}},scheduler._append_drag_marker=function(e){if(!e.parentNode){var t=scheduler._els.dhx_cal_data[0],a=t.lastChild;a.className&&a.className.indexOf("dhx_scale_holder")<0&&a.previousSibling&&(a=a.previousSibling),a&&0===a.className.indexOf("dhx_scale_holder")&&a.appendChild(e)}},scheduler._update_marker_position=function(e,t){var a=scheduler._calc_event_y(t,0);e.style.top=a.top+"px",e.style.height=a.height+"px"},scheduler.highlightEventPosition=function(e){
var t=document.createElement("div");t.setAttribute("event_id",e.id),this._rendered.push(t),this._update_marker_position(t,e);var a=this.templates.drag_marker_class(e.start_date,e.end_date,e),n=this.templates.drag_marker_content(e.start_date,e.end_date,e);t.className="dhx_drag_marker",a&&(t.className+=" "+a),n&&(t.innerHTML=n),this._append_drag_marker(t)},scheduler._loaded={},scheduler._load=function(e,t){if(e=e||this._load_url){e+=(-1==e.indexOf("?")?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),
this.config.prevent_cache&&(e+="&uid="+this.uid());var a;if(t=t||this._date,this._load_mode){var n=this.templates.load_format;for(t=this.date[this._load_mode+"_start"](new Date(t.valueOf()));t>this._min_date;)t=this.date.add(t,-1,this._load_mode);a=t;for(var i=!0;a<this._max_date;)a=this.date.add(a,1,this._load_mode),this._loaded[n(t)]&&i?t=this.date.add(t,1,this._load_mode):i=!1;var r=a;do a=r,r=this.date.add(a,-1,this._load_mode);while(r>t&&this._loaded[n(r)]);if(t>=a)return!1;for(dhtmlxAjax.get(e+"&from="+n(t)+"&to="+n(a),function(e){
scheduler.on_load(e)});a>t;)this._loaded[n(t)]=!0,t=this.date.add(t,1,this._load_mode)}else dhtmlxAjax.get(e,function(e){scheduler.on_load(e)});return this.callEvent("onXLS",[]),!0}},scheduler.on_load=function(e){var t,a=!1;if(this._process&&"xml"!=this._process)try{t=this[this._process].parse(e.xmlDoc.responseText)}catch(n){a=!0}else t=this._magic_parser(e),t||(a=!0);a&&(this.callEvent("onLoadError",[e.xmlDoc]),t=[]),scheduler._process_loading(t),this.callEvent("onXLE",[])},scheduler._process_loading=function(e){
this._loading=!0,this._not_render=!0;for(var t=0;t<e.length;t++)this.callEvent("onEventLoading",[e[t]])&&this.addEvent(e[t]);this._not_render=!1,this._render_wait&&this.render_view_data(),this._loading=!1,this._after_call&&this._after_call(),this._after_call=null},scheduler._init_event=function(e){e.text=e.text||e._tagvalue||"",e.start_date=scheduler._init_date(e.start_date),e.end_date=scheduler._init_date(e.end_date)},scheduler._init_date=function(e){return e?"string"==typeof e?scheduler.templates.xml_date(e):new Date(e):null;

},scheduler.json={},scheduler.json.parse=function(data){"string"==typeof data&&(scheduler._temp=eval("("+data+")"),data=scheduler._temp?scheduler._temp.data||scheduler._temp.d||scheduler._temp:[]),data.dhx_security&&(dhtmlx.security_key=data.dhx_security);var collections=scheduler._temp&&scheduler._temp.collections?scheduler._temp.collections:{},collections_loaded=!1;for(var key in collections)if(collections.hasOwnProperty(key)){collections_loaded=!0;var collection=collections[key],arr=scheduler.serverList[key];

if(!arr)continue;arr.splice(0,arr.length);for(var j=0;j<collection.length;j++){var option=collection[j],obj={key:option.value,label:option.label};for(var option_key in option)if(option.hasOwnProperty(option_key)){if("value"==option_key||"label"==option_key)continue;obj[option_key]=option[option_key]}arr.push(obj)}}collections_loaded&&scheduler.callEvent("onOptionsLoad",[]);for(var evs=[],i=0;i<data.length;i++){var event=data[i];scheduler._init_event(event),evs.push(event)}return evs},scheduler.parse=function(e,t){
this._process=t,this.on_load({xmlDoc:{responseText:e}})},scheduler.load=function(e,t){"string"==typeof t&&(this._process=t,t=arguments[2]),this._load_url=e,this._after_call=t,this._load(e,this._date)},scheduler.setLoadMode=function(e){"all"==e&&(e=""),this._load_mode=e},scheduler.serverList=function(e,t){return t?(this.serverList[e]=t.slice(0),this.serverList[e]):(this.serverList[e]=this.serverList[e]||[],this.serverList[e])},scheduler._userdata={},scheduler._magic_parser=function(e){var t;if(!e.getXMLTopNode){
var a=e.xmlDoc.responseText;e=new dtmlXMLLoaderObject(function(){}),e.loadXMLString(a)}if(t=e.getXMLTopNode("data"),"data"!=t.tagName)return null;var n=t.getAttribute("dhx_security");n&&(dhtmlx.security_key=n);for(var i=e.doXPath("//coll_options"),r=0;r<i.length;r++){var s=i[r].getAttribute("for"),d=this.serverList[s];if(d){d.splice(0,d.length);for(var o=e.doXPath(".//item",i[r]),_=0;_<o.length;_++){for(var l=o[_],h=l.attributes,c={key:o[_].getAttribute("value"),label:o[_].getAttribute("label")},u=0;u<h.length;u++){
var v=h[u];"value"!=v.nodeName&&"label"!=v.nodeName&&(c[v.nodeName]=v.nodeValue)}d.push(c)}}}i.length&&scheduler.callEvent("onOptionsLoad",[]);for(var f=e.doXPath("//userdata"),r=0;r<f.length;r++){var g=this._xmlNodeToJSON(f[r]);this._userdata[g.name]=g.text}var m=[];t=e.doXPath("//event");for(var r=0;r<t.length;r++){var p=m[r]=this._xmlNodeToJSON(t[r]);scheduler._init_event(p)}return m},scheduler._xmlNodeToJSON=function(e){for(var t={},a=0;a<e.attributes.length;a++)t[e.attributes[a].name]=e.attributes[a].value;

for(var a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];1==n.nodeType&&(t[n.tagName]=n.firstChild?n.firstChild.nodeValue:"")}return t.text||(t.text=e.firstChild?e.firstChild.nodeValue:""),t},scheduler.attachEvent("onXLS",function(){if(this.config.show_loading===!0){var e;e=this.config.show_loading=document.createElement("DIV"),e.className="dhx_loading",e.style.left=Math.round((this._x-128)/2)+"px",e.style.top=Math.round((this._y-15)/2)+"px",this._obj.appendChild(e)}}),scheduler.attachEvent("onXLE",function(){
var e=this.config.show_loading;e&&"object"==typeof e&&(this._obj.removeChild(e),this.config.show_loading=!0)}),scheduler.ical={parse:function(e){var t=e.match(RegExp(this.c_start+"[^\f]*"+this.c_end,""));if(t.length){t[0]=t[0].replace(/[\r\n]+(?=[a-z \t])/g," "),t[0]=t[0].replace(/\;[^:\r\n]*:/g,":");for(var a,n=[],i=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");null!==(a=i.exec(t));){for(var r,s={},d=/[^\r\n]+[\r\n]+/g;null!==(r=d.exec(a[1]));)this.parse_param(r.toString(),s);s.uid&&!s.id&&(s.id=s.uid),
n.push(s)}return n}},parse_param:function(e,t){var a=e.indexOf(":");if(-1!=a){var n=e.substr(0,a).toLowerCase(),i=e.substr(a+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,"");"summary"==n?n="text":"dtstart"==n?(n="start_date",i=this.parse_date(i,0,0)):"dtend"==n&&(n="end_date",i=this.parse_date(i,0,0)),t[n]=i}},parse_date:function(e,t,a){var n=e.split("T");n[1]&&(t=n[1].substr(0,2),a=n[1].substr(2,2));var i=n[0].substr(0,4),r=parseInt(n[0].substr(4,2),10)-1,s=n[0].substr(6,2);return scheduler.config.server_utc&&!n[1]?new Date(Date.UTC(i,r,s,t,a)):new Date(i,r,s,t,a);

},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"},scheduler._lightbox_controls={},scheduler.formSection=function(e){var t=this.config.lightbox.sections,a=0;for(a;a<t.length&&t[a].name!=e;a++);var n=t[a];scheduler._lightbox||scheduler.getLightbox();var i=document.getElementById(n.id),r=i.nextSibling,s={section:n,header:i,node:r,getValue:function(e){return scheduler.form_blocks[n.type].get_value(r,e||{},n)},setValue:function(e,t){return scheduler.form_blocks[n.type].set_value(r,e,t||{},n);

}},d=scheduler._lightbox_controls["get_"+n.type+"_control"];return d?d(s):s},scheduler._lightbox_controls.get_template_control=function(e){return e.control=e.node,e},scheduler._lightbox_controls.get_select_control=function(e){return e.control=e.node.getElementsByTagName("select")[0],e},scheduler._lightbox_controls.get_textarea_control=function(e){return e.control=e.node.getElementsByTagName("textarea")[0],e},scheduler._lightbox_controls.get_time_control=function(e){return e.control=e.node.getElementsByTagName("select"),
e},scheduler.form_blocks={template:{render:function(e){var t=(e.height||"30")+"px";return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+t+";'></div>"},set_value:function(e,t,a,n){e.innerHTML=t||""},get_value:function(e,t,a){return e.innerHTML||""},focus:function(e){}},textarea:{render:function(e){var t=(e.height||"130")+"px";return"<div class='dhx_cal_ltext' style='height:"+t+";'><textarea></textarea></div>"},set_value:function(e,t,a){e.firstChild.value=t||""},get_value:function(e,t){
return e.firstChild.value},focus:function(e){var t=e.firstChild;scheduler._focus(t,!0)}},select:{render:function(e){for(var t=(e.height||"23")+"px",a="<div class='dhx_cal_ltext' style='height:"+t+";'><select style='width:100%;'>",n=0;n<e.options.length;n++)a+="<option value='"+e.options[n].key+"'>"+e.options[n].label+"</option>";return a+="</select></div>"},set_value:function(e,t,a,n){var i=e.firstChild;!i._dhx_onchange&&n.onchange&&(i.onchange=n.onchange,i._dhx_onchange=!0),"undefined"==typeof t&&(t=(i.options[0]||{}).value),
i.value=t||""},get_value:function(e,t){return e.firstChild.value},focus:function(e){var t=e.firstChild;scheduler._focus(t,!0)}},time:{render:function(e){e.time_format||(e.time_format=["%H:%i","%d","%m","%Y"]),e._time_format_order={};var t=e.time_format,a=scheduler.config,n=this.date.date_part(scheduler._currentDate()),i=1440,r=0;scheduler.config.limit_time_select&&(i=60*a.last_hour+1,r=60*a.first_hour,n.setHours(a.first_hour));for(var s="",d=0;d<t.length;d++){var o=t[d];switch(d>0&&(s+=" "),o){case"%Y":
e._time_format_order[3]=d,s+="<select>";for(var _=n.getFullYear()-5,l=0;10>l;l++)s+="<option value='"+(_+l)+"'>"+(_+l)+"</option>";s+="</select> ";break;case"%m":e._time_format_order[2]=d,s+="<select>";for(var l=0;12>l;l++)s+="<option value='"+l+"'>"+this.locale.date.month_full[l]+"</option>";s+="</select>";break;case"%d":e._time_format_order[1]=d,s+="<select>";for(var l=1;32>l;l++)s+="<option value='"+l+"'>"+l+"</option>";s+="</select>";break;case"%H:%i":e._time_format_order[0]=d,s+="<select>";var l=r,h=n.getDate();

for(e._time_values=[];i>l;){var c=this.templates.time_picker(n);s+="<option value='"+l+"'>"+c+"</option>",e._time_values.push(l),n.setTime(n.valueOf()+60*this.config.time_step*1e3);var u=n.getDate()!=h?1:0;l=24*u*60+60*n.getHours()+n.getMinutes()}s+="</select>"}}return"<div style='height:30px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+s+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"+s+"</div>"},set_value:function(e,t,a,n){function i(e,t,a){for(var i=n._time_values,r=60*a.getHours()+a.getMinutes(),s=r,d=!1,o=0;o<i.length;o++){
var l=i[o];if(l===r){d=!0;break}r>l&&(s=l)}e[t+_[0]].value=d?r:s,d||s||(e[t+_[0]].selectedIndex=-1),e[t+_[1]].value=a.getDate(),e[t+_[2]].value=a.getMonth(),e[t+_[3]].value=a.getFullYear()}var r,s,d=scheduler.config,o=e.getElementsByTagName("select"),_=n._time_format_order;if(d.full_day){if(!e._full_day){var l="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+scheduler.locale.labels.full_day+"&nbsp;</label></input>";scheduler.config.wide_form||(l=e.previousSibling.innerHTML+l),
e.previousSibling.innerHTML=l,e._full_day=!0}var h=e.previousSibling.getElementsByTagName("input")[0];h.checked=0===scheduler.date.time_part(a.start_date)&&0===scheduler.date.time_part(a.end_date),o[_[0]].disabled=h.checked,o[_[0]+o.length/2].disabled=h.checked,h.onclick=function(){if(h.checked){var t={};scheduler.form_blocks.time.get_value(e,t,n),r=scheduler.date.date_part(t.start_date),s=scheduler.date.date_part(t.end_date),(+s==+r||+s>=+r&&(0!==a.end_date.getHours()||0!==a.end_date.getMinutes()))&&(s=scheduler.date.add(s,1,"day"));

}else r=null,s=null;o[_[0]].disabled=h.checked,o[_[0]+o.length/2].disabled=h.checked,i(o,0,r||a.start_date),i(o,4,s||a.end_date)}}if(d.auto_end_date&&d.event_duration)for(var c=function(){r=new Date(o[_[3]].value,o[_[2]].value,o[_[1]].value,0,o[_[0]].value),s=new Date(r.getTime()+60*scheduler.config.event_duration*1e3),i(o,4,s)},u=0;4>u;u++)o[u].onchange=c;i(o,0,a.start_date),i(o,4,a.end_date)},get_value:function(e,t,a){var n=e.getElementsByTagName("select"),i=a._time_format_order;if(t.start_date=new Date(n[i[3]].value,n[i[2]].value,n[i[1]].value,0,n[i[0]].value),
t.end_date=new Date(n[i[3]+4].value,n[i[2]+4].value,n[i[1]+4].value,0,n[i[0]+4].value),!n[i[3]].value||!n[i[3]+4].value){var r=this.getEvent(this._lightbox_id);r&&(t.start_date=r.start_date,t.end_date=r.end_date)}return t.end_date<=t.start_date&&(t.end_date=scheduler.date.add(t.start_date,scheduler.config.time_step,"minute")),{start_date:new Date(t.start_date),end_date:new Date(t.end_date)}},focus:function(e){scheduler._focus(e.getElementsByTagName("select")[0])}}},scheduler.showCover=function(e){
if(e){e.style.display="block";var t=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,a=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,n=window.innerHeight||document.documentElement.clientHeight;e.style.top=t?Math.round(t+Math.max((n-e.offsetHeight)/2,0))+"px":Math.round(Math.max((n-e.offsetHeight)/2,0)+9)+"px",e.style.left=document.documentElement.scrollWidth>document.body.offsetWidth?Math.round(a+(document.body.offsetWidth-e.offsetWidth)/2)+"px":Math.round((document.body.offsetWidth-e.offsetWidth)/2)+"px";

}this.show_cover()},scheduler.showLightbox=function(e){if(e){if(!this.callEvent("onBeforeLightbox",[e]))return void(this._new_event&&(this._new_event=null));var t=this.getLightbox();this.showCover(t),this._fill_lightbox(e,t),this.callEvent("onLightbox",[e])}},scheduler._fill_lightbox=function(e,t){var a=this.getEvent(e),n=t.getElementsByTagName("span");scheduler.templates.lightbox_header?(n[1].innerHTML="",n[2].innerHTML=scheduler.templates.lightbox_header(a.start_date,a.end_date,a)):(n[1].innerHTML=this.templates.event_header(a.start_date,a.end_date,a),
n[2].innerHTML=(this.templates.event_bar_text(a.start_date,a.end_date,a)||"").substr(0,70));for(var i=this.config.lightbox.sections,r=0;r<i.length;r++){var s=i[r],d=document.getElementById(s.id).nextSibling,o=this.form_blocks[s.type],_=void 0!==a[s.map_to]?a[s.map_to]:s.default_value;o.set_value.call(this,d,_,a,s),i[r].focus&&o.focus.call(this,d)}scheduler._lightbox_id=e},scheduler._lightbox_out=function(e){for(var t=this.config.lightbox.sections,a=0;a<t.length;a++){var n=document.getElementById(t[a].id);

n=n?n.nextSibling:n;var i=this.form_blocks[t[a].type],r=i.get_value.call(this,n,e,t[a]);"auto"!=t[a].map_to&&(e[t[a].map_to]=r)}return e},scheduler._empty_lightbox=function(e){{var t=scheduler._lightbox_id,a=this.getEvent(t);this.getLightbox()}this._lame_copy(a,e),this.setEvent(a.id,a),this._edit_stop_event(a,!0),this.render_view_data()},scheduler.hide_lightbox=function(e){this.hideCover(this.getLightbox()),this._lightbox_id=null,this.callEvent("onAfterLightbox",[])},scheduler.hideCover=function(e){
e&&(e.style.display="none"),this.hide_cover()},scheduler.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},scheduler.show_cover=function(){if(!this._cover){this._cover=document.createElement("DIV"),this._cover.className="dhx_cal_cover";var e=void 0!==document.height?document.height:document.body.offsetHeight,t=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(e,t)+"px",document.body.appendChild(this._cover);

}},scheduler.save_lightbox=function(){var e=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));(!this.checkEvent("onEventSave")||this.callEvent("onEventSave",[this._lightbox_id,e,this._new_event]))&&(this._empty_lightbox(e),this.hide_lightbox())},scheduler.startLightbox=function(e,t){this._lightbox_id=e,this._custom_lightbox=!0,this._temp_lightbox=this._lightbox,this._lightbox=t,this.showCover(t)},scheduler.endLightbox=function(e,t){this._edit_stop_event(scheduler.getEvent(this._lightbox_id),e),
e&&scheduler.render_view_data(),this.hideCover(t),this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1),this._temp_lightbox=this._lightbox_id=null},scheduler.resetLightbox=function(){scheduler._lightbox&&!scheduler._custom_lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox),scheduler._lightbox=null},scheduler.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]),this.endLightbox(!1),this.hide_lightbox()},
scheduler._init_lightbox_events=function(){this.getLightbox().onclick=function(e){var t=e?e.target:event.srcElement;if(t.className||(t=t.previousSibling),t&&t.className)switch(t.className){case"dhx_save_btn":scheduler.save_lightbox();break;case"dhx_delete_btn":var a=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(a,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(scheduler._lightbox_id),scheduler._new_event=null,scheduler.hide_lightbox()});break;case"dhx_cancel_btn":
scheduler.cancel_lightbox();break;default:if(t.getAttribute("dhx_button"))scheduler.callEvent("onLightboxButton",[t.className,t,e]);else{var n,i,r;-1!=t.className.indexOf("dhx_custom_button")&&(-1!=t.className.indexOf("dhx_custom_button_")?(n=t.parentNode.getAttribute("index"),r=t.parentNode.parentNode):(n=t.getAttribute("index"),r=t.parentNode,t=t.firstChild)),n&&(i=scheduler.form_blocks[scheduler.config.lightbox.sections[n].type],i.button_click(n,t,r,r.nextSibling))}}},this.getLightbox().onkeydown=function(e){
switch((e||event).keyCode){case scheduler.keys.edit_save:if((e||event).shiftKey)return;scheduler.save_lightbox();break;case scheduler.keys.edit_cancel:scheduler.cancel_lightbox()}}},scheduler.setLightboxSize=function(){var e=this._lightbox;if(e){var t=e.childNodes[1];t.style.height="0px",t.style.height=t.scrollHeight+"px",e.style.height=t.scrollHeight+scheduler.xy.lightbox_additional_height+"px",t.style.height=t.scrollHeight+"px"}},scheduler._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",scheduler._move_while_dnd),
dhtmlxEvent(document.body,"mouseup",scheduler._finish_dnd),scheduler._init_dnd_events=function(){}},scheduler._move_while_dnd=function(e){if(scheduler._dnd_start_lb){document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0);var t=scheduler.getLightbox(),a=e&&e.target?[e.pageX,e.pageY]:[event.clientX,event.clientY];t.style.top=scheduler._lb_start[1]+a[1]-scheduler._dnd_start_lb[1]+"px",t.style.left=scheduler._lb_start[0]+a[0]-scheduler._dnd_start_lb[0]+"px";

}},scheduler._ready_to_dnd=function(e){var t=scheduler.getLightbox();scheduler._lb_start=[parseInt(t.style.left,10),parseInt(t.style.top,10)],scheduler._dnd_start_lb=e&&e.target?[e.pageX,e.pageY]:[event.clientX,event.clientY]},scheduler._finish_dnd=function(){scheduler._lb_start&&(scheduler._lb_start=scheduler._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)},scheduler.getLightbox=function(){if(!this._lightbox){var e=document.createElement("DIV");

e.className="dhx_cal_light",scheduler.config.wide_form&&(e.className+=" dhx_cal_light_wide"),scheduler.form_blocks.recurring&&(e.className+=" dhx_cal_light_rec"),/msie|MSIE 6/.test(navigator.userAgent)&&(e.className+=" dhx_ie6"),e.style.visibility="hidden";for(var t=this._lightbox_template,a=this.config.buttons_left,n=0;n<a.length;n++)t+="<div class='dhx_btn_set dhx_left_btn_set "+a[n]+"_set'><div dhx_button='1' class='"+a[n]+"'></div><div>"+scheduler.locale.labels[a[n]]+"</div></div>";a=this.config.buttons_right;

for(var n=0;n<a.length;n++)t+="<div class='dhx_btn_set dhx_right_btn_set "+a[n]+"_set' style='float:right;'><div dhx_button='1' class='"+a[n]+"'></div><div>"+scheduler.locale.labels[a[n]]+"</div></div>";t+="</div>",e.innerHTML=t,scheduler.config.drag_lightbox&&(e.firstChild.onmousedown=scheduler._ready_to_dnd,e.firstChild.onselectstart=function(){return!1},e.firstChild.style.cursor="pointer",scheduler._init_dnd_events()),document.body.insertBefore(e,document.body.firstChild),this._lightbox=e;var i=this.config.lightbox.sections;

t="";for(var n=0;n<i.length;n++){var r=this.form_blocks[i[n].type];if(r){i[n].id="area_"+this.uid();var s="";i[n].button&&(s="<div class='dhx_custom_button' index='"+n+"'><div class='dhx_custom_button_"+i[n].button+"'></div><div>"+this.locale.labels["button_"+i[n].button]+"</div></div>"),this.config.wide_form&&(t+="<div class='dhx_wrap_section'>");var d=this.locale.labels["section_"+i[n].name];"string"!=typeof d&&(d=i[n].name),t+="<div id='"+i[n].id+"' class='dhx_cal_lsection'>"+s+d+"</div>"+r.render.call(this,i[n]),
t+="</div>"}}for(var o=e.getElementsByTagName("div"),n=0;n<o.length;n++){var _=o[n];if("dhx_cal_larea"==_.className){_.innerHTML=t;break}}this.setLightboxSize(),this._init_lightbox_events(this),e.style.display="none",e.style.visibility="visible"}return this._lightbox},scheduler.attachEvent("onEventIdChange",function(e,t){this._lightbox_id==e&&(this._lightbox_id=t)}),scheduler._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span></div><div class='dhx_cal_larea'></div>",
scheduler._init_touch_events=function(){"force"!=this.config.touch&&(this.config.touch=this.config.touch&&(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("Touch"))),this.config.touch&&(this.xy.scroll_width=0,window.navigator.msPointerEnabled?(this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(e){return e.pointerType==e.MSPOINTER_TYPE_MOUSE?null:e},function(e){return!e||e.pointerType==e.MSPOINTER_TYPE_MOUSE;

}),this._obj.ondblclick=function(){}):this._touch_events(["touchmove","touchstart","touchend"],function(e){return e.touches&&e.touches.length>1?null:e.touches[0]?{target:e.target,pageX:e.touches[0].pageX,pageY:e.touches[0].pageY}:e},function(){return!1}))},scheduler._touch_events=function(e,t,a){function n(e,t,a){dhtmlxEvent(e,t,function(e){return scheduler._is_lightbox_open()?!0:a(e)})}function i(e,t,a){if(e&&t){var n=Math.abs(e.pageY-t.pageY),i=Math.abs(e.pageX-t.pageX);i>a&&(!n||i/n>3)&&(e.pageX>t.pageX?scheduler._click.dhx_cal_next_button():scheduler._click.dhx_cal_prev_button());

}}function r(e){var t=scheduler.getState().drag_mode,a=scheduler.matrix?scheduler.matrix[scheduler._mode]:!1,n=scheduler.render_view_data;"create"==t&&a&&(scheduler.render_view_data=function(){for(var e=scheduler.getState().drag_id,t=scheduler.getEvent(e),n=a.y_property,i=scheduler.getEvents(t.start_date,t.end_date),r=0;r<i.length;r++)i[r][n]!=t[n]&&(i.splice(r,1),r--);t._sorder=i.length-1,t._count=i.length,this.render_data([t],scheduler.getState().mode)}),scheduler._on_mouse_move(e),"create"==t&&a&&(scheduler.render_view_data=n);

}function s(e){scheduler._hide_global_tip(),l&&(scheduler._on_mouse_up(t(e||event)),scheduler._temp_touch_block=!1),scheduler._drag_id=null,scheduler._drag_mode=null,scheduler._drag_pos=null,clearTimeout(_),l=c=!1,h=!0}var d,o,_,l,h,c,u=-1!=navigator.userAgent.indexOf("Android")&&-1!=navigator.userAgent.indexOf("WebKit"),v=0;n(document.body,e[0],function(e){if(!a(e)){if(l)return r(t(e)),scheduler._update_global_tip(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!1;if(o&&u&&i(o,t(e),0),o=t(e),
c)return o?void((d.target!=o.target||Math.abs(d.pageX-o.pageX)>5||Math.abs(d.pageY-o.pageY)>5)&&(h=!0,clearTimeout(_))):void(h=!0)}}),n(this._els.dhx_cal_data[0],"scroll",s),n(this._els.dhx_cal_data[0],"touchcancel",s),n(this._els.dhx_cal_data[0],"contextmenu",function(e){return c?(e&&e.preventDefault&&e.preventDefault(),(e||event).cancelBubble=!0,!1):void 0}),n(this._els.dhx_cal_data[0],e[1],function(e){if(!a(e)){var n;if(l=h=!1,c=!0,scheduler._temp_touch_block=!0,n=o=t(e),!n)return void(h=!0);var i=new Date;

if(!h&&!l&&250>i-v)return scheduler._click.dhx_cal_data(n),window.setTimeout(function(){scheduler._on_dbl_click(n)},50),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,scheduler._block_next_stop=!0,!1;if(v=i,!h&&!l&&scheduler.config.touch_drag){var r=scheduler._locate_event(document.activeElement),s=scheduler._locate_event(n.target),u=d?scheduler._locate_event(d.target):null;if(r&&s&&r==s&&r!=u)return e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,scheduler._ignore_next_click=!1,scheduler._click.dhx_cal_data(n),
d=n,!1;_=setTimeout(function(){l=!0;var e=d.target;e&&e.className&&-1!=e.className.indexOf("dhx_body")&&(e=e.previousSibling),scheduler._on_mouse_down(d,e),scheduler._drag_mode&&"create"!=scheduler._drag_mode&&scheduler.for_rendered(scheduler._drag_id,function(e,t){e.style.display="none",scheduler._rendered.splice(t,1)}),scheduler.config.touch_tip&&scheduler._show_global_tip(),scheduler._on_mouse_move(d)},scheduler.config.touch_drag),d=n}}}),n(this._els.dhx_cal_data[0],e[2],function(e){return a(e)?void 0:(l||i(d,o,200),
l&&(scheduler._ignore_next_click=!0),s(e),scheduler._block_next_stop?(scheduler._block_next_stop=!1,e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!1):void 0)}),dhtmlxEvent(document.body,e[2],s)},scheduler._show_global_tip=function(){scheduler._hide_global_tip();var e=scheduler._global_tip=document.createElement("DIV");e.className="dhx_global_tip",scheduler._update_global_tip(1),document.body.appendChild(e)},scheduler._update_global_tip=function(e){var t=scheduler._global_tip;if(t){var a="";

if(scheduler._drag_id&&!e){var n=scheduler.getEvent(scheduler._drag_id);n&&(a="<div>"+(n._timed?scheduler.templates.event_header(n.start_date,n.end_date,n):scheduler.templates.day_date(n.start_date,n.end_date,n))+"</div>")}t.innerHTML="create"==scheduler._drag_mode||"new-size"==scheduler._drag_mode?(scheduler.locale.drag_to_create||"Drag to create")+a:(scheduler.locale.drag_to_move||"Drag to move")+a}},scheduler._hide_global_tip=function(){var e=scheduler._global_tip;e&&e.parentNode&&(e.parentNode.removeChild(e),
scheduler._global_tip=0)},scheduler._dp_init=function(e){e._methods=["_set_event_text_style","","changeEventId","_dp_hook_delete"],this._dp_hook_delete=function(e){return this.deleteEvent(e,!0)},this.attachEvent("onEventAdded",function(t){!this._loading&&this._validId(t)&&e.setUpdated(t,!0,"inserted")}),this.attachEvent("onConfirmedBeforeEventDelete",function(t){if(this._validId(t)){var a=e.getState(t);return"inserted"==a||this._new_event?(e.setUpdated(t,!1),!0):"deleted"==a?!1:"true_deleted"==a?!0:(e.setUpdated(t,!0,"deleted"),
!1)}}),this.attachEvent("onEventChanged",function(t){!this._loading&&this._validId(t)&&e.setUpdated(t,!0,"updated")}),e._getRowData=function(e,t){var a=this.obj.getEvent(e),n={};for(var i in a)0!==i.indexOf("_")&&(n[i]=a[i]&&a[i].getUTCFullYear?this.obj.templates.xml_format(a[i]):a[i]);return n},e._clearUpdateFlag=function(){},e.attachEvent("insertCallback",scheduler._update_callback),e.attachEvent("updateCallback",scheduler._update_callback),e.attachEvent("deleteCallback",function(e,t){this.obj.setUserData(t,this.action_param,"true_deleted"),
this.obj.deleteEvent(t)})},scheduler._validId=function(e){return!0},scheduler.setUserData=function(e,t,a){e?this.getEvent(e)[t]=a:this._userdata[t]=a},scheduler.getUserData=function(e,t){return e?this.getEvent(e)[t]:this._userdata[t]},scheduler._set_event_text_style=function(e,t){this.for_rendered(e,function(e){e.style.cssText+=";"+t});var a=this.getEvent(e);a._text_style=t,this.event_updated(a)},scheduler._update_callback=function(e,t){var a=scheduler._xmlNodeToJSON(e.firstChild);a.text=a.text||a._tagvalue,
a.start_date=scheduler.templates.xml_date(a.start_date),a.end_date=scheduler.templates.xml_date(a.end_date),scheduler.addEvent(a)},scheduler._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},scheduler._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},scheduler._configure=function(e,t,a){for(var n in t)"undefined"==typeof e[n]&&(e[n]=t[n][a]);

},scheduler._skin_init=function(){if(!scheduler.skin)for(var e=document.getElementsByTagName("link"),t=0;t<e.length;t++){var a=e[t].href.match("dhtmlxscheduler_([a-z]+).css");if(a){scheduler.skin=a[1];break}}var n=0;if(!scheduler.skin||"classic"!==scheduler.skin&&"glossy"!==scheduler.skin||(n=1),this._configure(scheduler.config,scheduler._skin_settings,n),this._configure(scheduler.xy,scheduler._skin_xy,n),"flat"===scheduler.skin&&(scheduler.xy.scale_height=35,scheduler.templates.hour_scale=function(e){
var t=e.getMinutes();t=10>t?"0"+t:t;var a="<span class='dhx_scale_h'>"+e.getHours()+"</span><span class='dhx_scale_m'>&nbsp;"+t+"</span>";return a}),!n){var i=scheduler.config.minicalendar;i&&(i.padding=14),scheduler.templates.event_bar_date=function(e,t,a){return"• <b>"+scheduler.templates.event_date(e)+"</b> "},scheduler.attachEvent("onTemplatesReady",function(){var e=scheduler.date.date_to_str("%d");scheduler.templates._old_month_day||(scheduler.templates._old_month_day=scheduler.templates.month_day);

var t=scheduler.templates._old_month_day;if(scheduler.templates.month_day=function(a){if("month"==this._mode){var n=e(a);return 1==a.getDate()&&(n=scheduler.locale.date.month_full[a.getMonth()]+" "+n),+a==+scheduler.date.date_part(new Date)&&(n=scheduler.locale.labels.dhx_cal_today_button+" "+n),n}return t.call(this,a)},scheduler.config.fix_tab_position){for(var a=scheduler._els.dhx_cal_navline[0].getElementsByTagName("div"),n=null,i=211,r=0;r<a.length;r++){var s=a[r],d=s.getAttribute("name");if(d)switch(s.style.right="auto",
d){case"day_tab":s.style.left="14px",s.className+=" dhx_cal_tab_first";break;case"week_tab":s.style.left="75px";break;case"month_tab":s.style.left="136px",s.className+=" dhx_cal_tab_last";break;default:s.style.left=i+"px",s.className+=" dhx_cal_tab_standalone",i=i+14+s.offsetWidth}else 0===(s.className||"").indexOf("dhx_minical_icon")&&s.parentNode==scheduler._els.dhx_cal_navline[0]&&(n=s)}n&&(n.style.left=i+"px")}}),scheduler._skin_init=function(){}}},window.jQuery&&!function(e){var t=0,a=[];e.fn.dhx_scheduler=function(n){
if("string"!=typeof n){var i=[];return this.each(function(){if(this&&this.getAttribute)if(this.getAttribute("dhxscheduler"))i.push(window[this.getAttribute("dhxscheduler")]);else{var e="scheduler";t&&(e="scheduler"+(t+1),window[e]=Scheduler.getSchedulerInstance());var a=window[e];this.setAttribute("dhxscheduler",e);for(var r in n)"data"!=r&&(a.config[r]=n[r]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',
this.className+=" dhx_cal_container"),a.init(this,a.config.date,a.config.mode),n.data&&a.parse(n.data),i.push(a),t++}}),1===i.length?i[0]:i}return a[n]?a[n].apply(this,[]):void e.error("Method "+n+" does not exist on jQuery.dhx_scheduler")}}(jQuery),function(){function e(e,t,a){t&&(e._date=t),a&&(e._mode=a)}var t=scheduler.setCurrentView,a=scheduler.updateView,n=null,i=null,r=function(t,r){var s=this;window.clearTimeout(i),window.clearTimeout(n),e(this,t,r),i=setTimeout(function(){s.callEvent("onBeforeViewChange",[s._mode,s._date,r||s._mode,t||s._date])&&(a.call(s,t,r),
s.callEvent("onViewChange",[s._mode,s._date]),window.clearTimeout(n),i=0)},scheduler.config.delay_render)},s=function(t,r){var s=this,d=arguments;e(this,t,r),window.clearTimeout(n),n=setTimeout(function(){i||a.apply(s,d)},scheduler.config.delay_render)};scheduler.attachEvent("onSchedulerReady",function(){scheduler.config.delay_render?(scheduler.setCurrentView=r,scheduler.updateView=s):(scheduler.setCurrentView=t,scheduler.updateView=a)})}();for(var i=0;i<Scheduler._schedulerPlugins.length;i++)Scheduler._schedulerPlugins[i](scheduler);

return scheduler._internal_id=Scheduler._seed++,Scheduler.$syncFactory&&Scheduler.$syncFactory(scheduler),scheduler},window.scheduler=Scheduler.getSchedulerInstance(),dhtmlx&&dhtmlx.attaches&&(dhtmlx.attaches.attachScheduler=function(e,t,a,n){var a=a||'<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>',i=document.createElement("DIV");return i.id="dhxSchedObj_"+this._genStr(12),
i.innerHTML='<div id="'+i.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>'+a+'</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>',document.body.appendChild(i.firstChild),this.attachObject(i.id,!1,!0),this.vs[this.av].sched=n,this.vs[this.av].schedId=i.id,n.setSizes=n.updateView,
n.destructor=function(){},n.init(i.id,e,t),this.vs[this._viewRestore()].sched});